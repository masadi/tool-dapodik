import{_ as da,r as R,V as ua,a as ma,i as _a}from"./VForm-Lv2glWH9.js";import{a5 as pa,a6 as ka,at as fa,ad as ca,aQ as ga,aR as ba,aS as va,ai as ya,aD as ha,ae as Va,a9 as ja,b as e,ak as Ca,ab as Da,al as Pa,aJ as Sa,am as xa,aT as Na,aU as Ta,ac as wa,aV as Aa,E as Ra,r as _,c as k,f as c,l as t,e as l,F as P,k as S,a2 as X,a as $a,o as r,ay as qa,s as p,a0 as x,Z as aa,d as s,t as u,h as ea,$ as Ba}from"./main-Dzs_CAgs.js";import{_ as Ia}from"./AppAutocomplete-NzqZNerQ.js";import{_ as La}from"./AppTextField-Ciy4apEb.js";import{_ as Fa}from"./JamSinkron-BVOo2c2h.js";import{u as Ka}from"./useApi-BWjN2qok.js";import{c as Ua,V as H}from"./VTable-NlKXlxV7.js";import{$ as Y}from"./api-BWdT9Mw5.js";import{V as N,a as L,b as F}from"./VCard-0saSSTiW.js";import{V as K}from"./VDivider-DvomKPbr.js";import{V as U}from"./VCardText-C94KSfEt.js";import{q as za}from"./VDataTable-DN2zIp5n.js";import{V as Ja}from"./VAlert-D0Bkx9S3.js";import{V as T,a as m}from"./VRow-C6oix2Iy.js";import"./VDialog-CGRrU3qe.js";import"./forwardRefs-BZjvUaET.js";import"./VImg-Bz1ivnlY.js";import"./VTextField-DDvuboFK.js";import"./VList-uaFLNDuS.js";import"./VAvatar-D763mIUj.js";import"./VMenu-CxQ93pQk.js";import"./VChip-HbpO5J_9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CvOPxmL5.js";/* empty css              */const Ma=ka({color:String,...Aa(),...wa(),...Ta(),...Na(),...xa(),...Sa(),...Pa(),...Da(),...Ca()},"VSheet"),Ea=pa()({name:"VSheet",props:Ma(),setup(f,z){let{slots:w}=z;const{themeClasses:$}=fa(f),{backgroundColorClasses:q,backgroundColorStyles:J}=ca(()=>f.color),{borderClasses:y}=ga(f),{dimensionStyles:h}=ba(f),{elevationClasses:V}=va(f),{locationStyles:b}=ya(f),{positionClasses:d}=ha(f),{roundedClasses:C}=Va(f);return ja(()=>e(f.tag,{class:["v-sheet",$.value,q.value,y.value,V.value,d.value,C.value,f.class],style:[J.value,h.value,b.value,f.style]},w)),{}}}),Oa={key:0,class:"ms-3"},Ha={class:"clamp-text text-white mb-0"},Ya=["colspan"],Za={class:"py-2"},Qa={class:"py-2"},Wa={class:"py-2"},Ga={class:"py-2"},Xa={class:"py-2"},ae={key:1},ee=["onClick"],le={class:"text-center"},te={class:"text-center"},se={class:"text-center"},ne={class:"py-2"},oe={key:1},ie={key:0},$e={__name:"pd",setup(f){const z={dateFormat:"Y-m-d",locale:_a.Indonesian,altFormat:"j F Y",altInput:!0};Ra(async()=>{await J()});const w=_(!1),$=_(),q=_(!0),J=async()=>{var o,a;w.value=!0;try{let v=(await Ka(Ua("/cek-sekolah"))).data.value;$.value=v.sekolah,n.value.sekolah_id=(o=v.sekolah)==null?void 0:o.sekolah_id,n.value.tahun_ajaran_id=(a=v.semester)==null?void 0:a.tahun_ajaran_id,A.value.jenis_pendaftaran=v.jenis_pendaftaran,q.value=v.jam_sinkron}catch(D){console.error(D)}finally{w.value=!1}},y=_(),h=_(),V=_({jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,rombongan_belajar_id:null}),b=_(!1),d=_(),C=_(!1),A=_({jenis_pendaftaran:[],rombongan_belajar:[]}),la=async()=>{V.value.nik=void 0,d.value=void 0,n.value.peserta_didik=void 0,C.value=!1,h.value=void 0,y.value?(b.value=!0,await Y("/cari-data",{method:"POST",body:{data:"siswa",nik:y.value,sekolah_id:n.value.sekolah_id},async onResponse({response:o}){let a=o._data;C.value=!0,h.value=a.pd,d.value=a.result,A.value.rombongan_belajar=a.rombongan_belajar,n.value.ptk=d.value,b.value=!1}})):V.value.nik="NIK tidak boleh kosong"},Z=o=>{var a={1:"Lulus",2:"Mutasi",3:"Dikeluarkan",4:"Mengundurkan diri",5:"Putus Sekolah",6:"Wafat",7:"Hilang",8:"Alih Fungsi",9:"Pensiun",Z:"Lainnya"};if(o)return a[o]},Q=_(),n=_({data:"siswa",sekolah_id:null,nik:null,registrasi_id:null,jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,a_pernah_paud:null,a_pernah_tk:null,sekolah_asal:null,id_hobby:null,id_cita:null,rombongan_belajar_id:null,peserta_didik:null}),ta=()=>{var o;(o=Q.value)==null||o.validate().then(({valid:a})=>{a&&sa()})},B=_(!1),I=_({color:"",title:"",text:""}),sa=async()=>{b.value=!0,await Y("/daftar",{method:"POST",body:n.value,async onResponse({response:o}){let a=o._data;b.value=!1,B.value=!0,I.value=a}})},na=async()=>{n.value.registrasi_id=null,n.value.jenis_pendaftaran_id=null,n.value.tanggal_masuk_sekolah=null,n.value.nipd=null,n.value.a_pernah_paud=null,n.value.a_pernah_tk=null,n.value.sekolah_asal=null,n.value.id_hobby=null,n.value.id_cita=null,n.value.rombongan_belajar_id=null,n.value.peserta_didik=null,y.value=void 0,V.value={jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,rombongan_belajar_id:null},d.value=[],C.value=!1,A.value.rombongan_belajar=[]},M=async(o,a)=>{a&&(n.value.a_pernah_paud=a.a_pernah_paud,n.value.a_pernah_tk=a.a_pernah_tk,n.value.sekolah_asal=a.sekolah.nama,n.value.id_hobby=a.id_hobby,n.value.id_cita=a.id_cita),await Y("/cek-pd",{method:"POST",body:{sekolah_id:n.value.sekolah_id,peserta_didik_id:o.peserta_didik_id,nik:y.value},async onResponse({response:D}){const v=D._data;h.value=v.pd,Array.isArray(d.value)?n.value.peserta_didik=d.value.find(E=>E.peserta_didik_id===o.peserta_didik_id):n.value.peserta_didik=d.value}})},oa=o=>{console.log(o)};return(o,a)=>{const D=Fa,v=La,E=$a("RouterLink"),W=Ia,ia=ma,ra=da;return r(),k(P,null,[t(w)?(r(),c(N,{key:0,class:"text-center"},{default:l(()=>[e(qa,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(r(),k(P,{key:1},[t($)?(r(),c(N,{key:0},{default:l(()=>[e(L,{class:"pb-4"},{default:l(()=>[e(F,null,{default:l(()=>a[6]||(a[6]=[p("Tarik PD")])),_:1,__:[6]})]),_:1}),e(K),e(U,null,{default:l(()=>[t(q)?(r(),c(D,{key:0})):(r(),c(v,{key:1,modelValue:t(y),"onUpdate:modelValue":a[0]||(a[0]=i=>X(y)?y.value=i:null),required:"",clearable:"",placeholder:"Masukkan NIK",type:"text",rules:["requiredValidator"in o?o.requiredValidator:t(R)],"error-messages":t(V).nik},{append:l(()=>[e(x,{icon:o.$vuetify.display.smAndDown,onClick:la,disabled:t(b),loading:t(b)},{default:l(()=>[e(aa,{icon:"tabler-search",color:"#fff",size:"22"}),o.$vuetify.display.mdAndUp?(r(),k("span",Oa,"Cari...")):S("",!0)]),_:1},8,["icon","disabled","loading"])]),_:1},8,["modelValue","rules","error-messages"]))]),_:1})]),_:1})):(r(),c(N,{key:1,color:"#007BB6"},{default:l(()=>[e(U,null,{default:l(()=>[s("p",Ha,[a[8]||(a[8]=p(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),e(E,{class:"text-success ms-1",to:{name:"root"}},{default:l(()=>a[7]||(a[7]=[p(" disini ")])),_:1,__:[7]})])]),_:1})]),_:1})),t(C)?(r(),k(P,{key:2},[e(N,{class:"mt-4"},{default:l(()=>[e(L,{class:"pb-4"},{default:l(()=>[e(F,null,{default:l(()=>a[9]||(a[9]=[p("Hasil Pencarian")])),_:1,__:[9]})]),_:1}),e(K),t(d)?(r(),k(P,{key:0},[Array.isArray(t(d))?(r(),c(za,{key:1,headers:[{title:"Nama",key:"nama"},{title:"NIK",key:"nik"},{title:"NISN",key:"nisn"},{title:"Tempat, Tanggal Lahir",key:"tempat"},{title:"Nama Ibu Kandung",key:"nama_ibu_kandung"},{title:"Detil",key:"data-table-expand",align:"end"}],items:t(d),"item-value":"peserta_didik_id","show-expand":""},{"item.tempat":l(({item:i})=>[p(u(i.tempat_lahir)+", "+u(i.tanggal_lahir),1)]),"item.data-table-expand":l(({internalItem:i,isExpanded:j,toggleExpand:g})=>[e(x,{"append-icon":j(i)?"tabler-chevron-up":"tabler-chevron-down",text:j(i)?"Tutup":"Detil",class:"text-none",color:"medium-emphasis",size:"small",variant:"text",width:"105",border:"",slim:"",onClick:O=>g(i)},null,8,["append-icon","text","onClick"])]),"expanded-row":l(({columns:i,item:j})=>[s("tr",null,[s("td",{colspan:i.length,class:"py-2"},[e(Ea,{rounded:"lg",border:""},{default:l(()=>[e(H,{density:"compact"},{default:l(()=>[a[18]||(a[18]=s("tbody",{class:"bg-surface-light"},[s("tr",null,[s("th",null,"Nama Sekolah"),s("th",null,"NPSN"),s("th",null,"Jenis Keluar"),s("th",null,"Tanggal Keluar"),s("th",null,"Daftarkan")])],-1)),s("tbody",null,[j.registrasi_pd.length?(r(!0),k(P,{key:0},ea(j.registrasi_pd,g=>{var O,G;return r(),k("tr",{key:g.registrasi_id},[s("td",Za,u((O=g.sekolah)==null?void 0:O.nama),1),s("td",Qa,u((G=g.sekolah)==null?void 0:G.npsn),1),s("td",Wa,u(Z(g.jenis_keluar_id)),1),s("td",Ga,u(g.tanggal_keluar),1),s("td",Xa,[e(x,{size:"small",onClick:re=>M(j,g)},{default:l(()=>a[15]||(a[15]=[p("Daftarkan")])),_:2,__:[15]},1032,["onClick"])])])}),128)):(r(),k("tr",ae,[a[17]||(a[17]=s("td",{class:"py-2 text-center",colspan:"4"}," Tidak data untuk ditampilan ",-1)),s("td",null,[e(x,{size:"small",onClick:g=>M(j,null)},{default:l(()=>a[16]||(a[16]=[p("Daftarkan")])),_:2,__:[16]},1032,["onClick"])])]))])]),_:2,__:[18]},1024)]),_:2},1024)],8,Ya)])]),_:1},8,["items"])):(r(),c(H,{key:0},{default:l(()=>[s("tbody",null,[s("tr",null,[a[10]||(a[10]=s("td",null,"Nama",-1)),s("td",null,u(t(d).nama),1)]),s("tr",null,[a[11]||(a[11]=s("td",null,"NIK",-1)),s("td",null,u(t(d).nik),1)]),s("tr",null,[a[12]||(a[12]=s("td",null,"NISN",-1)),s("td",null,u(t(d).nisn),1)]),s("tr",null,[a[13]||(a[13]=s("td",null,"Tempat, Tanggal Lahir",-1)),s("td",null,u(t(d).tempat_lahir)+", "+u(t(d).tanggal_lahir),1)]),s("tr",null,[a[14]||(a[14]=s("td",null,"Nama Ibu Kandung",-1)),s("td",null,u(t(d).nama_ibu_kandung),1)])])]),_:1}))],64)):(r(),c(U,{key:1},{default:l(()=>a[19]||(a[19]=[p(" NIK tidak ditemukan! ")])),_:1,__:[19]}))]),_:1}),t(d)&&!Array.isArray(t(d))?(r(),c(N,{key:0,class:"mt-4"},{default:l(()=>[e(L,{class:"pb-4"},{default:l(()=>[e(F,null,{default:l(()=>a[20]||(a[20]=[p("Riwayat Pendidikan Siswa")])),_:1,__:[20]})]),_:1}),e(K),e(H,null,{default:l(()=>[a[23]||(a[23]=s("thead",null,[s("tr",null,[s("th",null,"Nama Sekolah"),s("th",{class:"text-center"},"NPSN"),s("th",{class:"text-center"},"Jenis Keluar"),s("th",{class:"text-center"},"Tanggal Keluar"),s("th",{class:"text-center"},"Daftarkan")])],-1)),s("tbody",null,[t(d).registrasi_pd.length?(r(!0),k(P,{key:0},ea(t(d).registrasi_pd,(i,j)=>(r(),k("tr",{key:i.registrasi_id},[s("td",null,[p(u(i.sekolah.nama)+" ",1),i.sekolah_id.toLowerCase()===t(n).sekolah_id?(r(),k("a",{key:0,href:"javascript:void(0)",onClick:g=>oa(i.registrasi_id)},[e(aa,{icon:"tabler-clipboard-check"})],8,ee)):S("",!0)]),s("td",le,u(i.sekolah.npsn),1),s("td",te,u(Z(i.jenis_keluar_id)),1),s("td",se,u(i.tanggal_keluar),1),s("td",ne,[e(x,{size:"small",onClick:g=>M(t(d),i)},{default:l(()=>a[21]||(a[21]=[p("Daftarkan")])),_:2,__:[21]},1032,["onClick"])])]))),128)):(r(),k("tr",oe,a[22]||(a[22]=[s("td",{colspan:"4",class:"py-4 text-center"}," Tidak ada data untuk ditampilkan ",-1)])))])]),_:1,__:[23]})]),_:1})):S("",!0),t(n).peserta_didik?(r(),c(N,{key:1,class:"mt-4"},{default:l(()=>[e(L,{class:"pb-4"},{default:l(()=>[e(F,null,{default:l(()=>a[24]||(a[24]=[p("Daftarkan Peserta Didik")])),_:1,__:[24]})]),_:1}),e(K),e(U,null,{default:l(()=>[t(h)?(r(),c(Ja,{key:0,color:"error"},{default:l(()=>[p(" Peserta Didik atas nama "+u(t(h).nama)+" telah terdaftar ",1),t(h).kelas?(r(),k("span",ie,"di Rombongan Belajar "+u(t(h).kelas.nama),1)):S("",!0)]),_:1})):(r(),c(ua,{key:1,ref_key:"refVForm",ref:Q,onSubmit:Ba(ta,["prevent"])},{default:l(()=>[e(T,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(T,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[25]||(a[25]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"jenis_pendaftaran_id"},"Jenis Pendaftaran ",-1)])),_:1,__:[25]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(W,{id:"jenis_ptk_id",modelValue:t(n).jenis_pendaftaran_id,"onUpdate:modelValue":a[1]||(a[1]=i=>t(n).jenis_pendaftaran_id=i),items:t(A).jenis_pendaftaran,placeholder:"== Pilih Jenis Pendaftaran ==","item-title":"nama","item-value":"jenis_pendaftaran_id",rules:["requiredValidator"in o?o.requiredValidator:t(R)],"error-messages":t(V).jenis_pendaftaran_id},null,8,["modelValue","items","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(T,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[26]||(a[26]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"tanggal_masuk_sekolah"},"Tanggal Masuk Sekolah ",-1)])),_:1,__:[26]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(ia,{id:"tanggal_masuk_sekolah",modelValue:t(n).tanggal_masuk_sekolah,"onUpdate:modelValue":a[2]||(a[2]=i=>t(n).tanggal_masuk_sekolah=i),rules:["requiredValidator"in o?o.requiredValidator:t(R)],placeholder:"== Pilih Tanggal ==",config:z},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(T,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[27]||(a[27]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"nipd"},"Nomor Induk Siswa",-1)])),_:1,__:[27]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(v,{id:"nipd",modelValue:t(n).nipd,"onUpdate:modelValue":a[3]||(a[3]=i=>t(n).nipd=i),placeholder:"Nomor Induk Siswa","persistent-placeholder":"",rules:["requiredValidator"in o?o.requiredValidator:t(R)],"error-messages":t(V).nipd},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(T,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[28]||(a[28]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1,__:[28]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(W,{id:"rombongan_belajar_id",modelValue:t(n).rombongan_belajar_id,"onUpdate:modelValue":a[4]||(a[4]=i=>t(n).rombongan_belajar_id=i),items:t(A).rombongan_belajar,placeholder:"== Pilih Rombongan Belajar ==","item-title":"nama","item-value":"rombongan_belajar_id",rules:["requiredValidator"in o?o.requiredValidator:t(R)],"error-messages":t(V).rombongan_belajar_id},null,8,["modelValue","items","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(T,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3"}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(x,{type:"submit",class:"me-4",disabled:t(b),loading:t(b)},{default:l(()=>a[29]||(a[29]=[p(" Simpan ")])),_:1,__:[29]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512))]),_:1})]),_:1})):S("",!0)],64)):S("",!0)],64)),e(ra,{isDialogVisible:t(B),"onUpdate:isDialogVisible":a[5]||(a[5]=i=>X(B)?B.value=i:null),"confirm-color":t(I).color,"confirm-title":t(I).title,"confirm-msg":t(I).text,onConfirm:na},null,8,["isDialogVisible","confirm-color","confirm-title","confirm-msg"])],64)}}};export{$e as default};
