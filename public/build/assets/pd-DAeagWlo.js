import{_ as E}from"./AppTextField-BvEaz0lZ.js";import{V as F,_ as I}from"./VSnackbar-0gybrv1g.js";import{u as C}from"./useApi-DyvcKpbi.js";import{c as D}from"./createUrl-KkOWSS81.js";import{$ as J}from"./api-DxSuTryf.js";import{V as j,a as M,b as q}from"./VCard-MdzLNOx0.js";import{E as O,r as _,w as T,f as x,c as W,l as t,e as o,b as i,a2 as G,F as H,a as X,o as b,ay as Y,s as m,d as p,a0 as Z,t as S,az as ee}from"./main-C8xu4-vM.js";import{V as z}from"./VDivider-CgZgS3oc.js";import{V as K}from"./VCardText-DAeSW8Wx.js";import{V as ae}from"./VSpacer-hDN-M_sN.js";import{V as te}from"./VDataTableServer-B7CPH5Qy.js";import{V as le,a as N}from"./VRow-A4HnvnDq.js";import"./VTextField-C54nE6Ao.js";import"./VImg-HiYQ4kB8.js";import"./forwardRefs-Dsi23SII.js";import"./VList-BOpeIbDM.js";import"./VAvatar-CEGz3YjL.js";import"./VMenu-BDEbuP5a.js";import"./VChip-DTz_HPEf.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VDataTable-63B7bGnf.js";import"./VTable-CBi0cRin.js";const se={class:"d-flex gap-2 align-center"},re={class:"d-flex align-center flex-wrap gap-4"},oe={class:"d-flex align-center gap-x-4"},ie={class:"d-flex flex-column"},ne={class:"text-base"},de={class:"text-sm"},ue={class:"clamp-text text-white mb-0"},Ne={__name:"pd",setup(_e){O(async()=>{await R()});const f=_(!1),v=_(),R=async()=>{var r;f.value=!0;try{let a=(await C(D("/cek-sekolah"))).data.value;v.value=a.sekolah,s.value.semester_id=(r=a.semester)==null?void 0:r.semester_id,v.value&&U()}catch(l){console.error(l)}finally{f.value=!1}},L=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"NISN",key:"nisn",align:"center"},{title:"Kelas",key:"kelas",align:"center",sortable:!1},{title:"Tinggi Badan",key:"tinggi",sortable:!1},{title:"Berat Badan",key:"berat",align:"center",sortable:!1},{title:"Jarak",key:"jarak",align:"center",sortable:!1},{title:"waktu",key:"waktu",align:"center",sortable:!1},{title:"Jml Saudara Kandung",key:"saudara",align:"center",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],d=_({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"nama",sortbydesc:"ASC"}),V=_(!1),y=_([]),w=_(0),Q=r=>{var l,a;d.value.sortby=(l=r[0])==null?void 0:l.key,d.value.sortbydesc=(a=r[0])==null?void 0:a.order},s=_({semester_id:null,tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),g=_(!1),U=async()=>{V.value=!0;try{let l=(await C(D("/periodik",{query:{q:d.value.searchQuery,page:d.value.page,per_page:d.value.itemsPerPage,sortby:d.value.sortby,sortbydesc:d.value.sortbydesc}}))).data.value;y.value=l.data.data,w.value=l.data.total,y.value.forEach(a=>{s.value.tinggi_badan[a.peserta_didik_id]=a.periodik?a.periodik.tinggi_badan:null,s.value.berat_badan[a.peserta_didik_id]=a.periodik?a.periodik.berat_badan:null,s.value.jarak_rumah_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.jarak_rumah_ke_sekolah:null,s.value.waktu_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.waktu_tempuh_ke_sekolah:null,s.value.menit_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.menit_tempuh_ke_sekolah:null,s.value.jumlah_saudara_kandung[a.peserta_didik_id]=a.periodik?a.periodik.jumlah_saudara_kandung:null})}catch(r){console.error(r)}finally{V.value=!1}};T(d,ee(()=>{U()},500),{deep:!0}),T(()=>d.value.searchQuery,()=>{d.value.page=1});const h=_([]),$=_(),u=_({tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),A=async r=>{$.value=r,h.value[r]=!0,await J("/periodik",{method:"POST",body:{semester_id:s.value.semester_id,peserta_didik_id:r,tinggi_badan:s.value.tinggi_badan[r],berat_badan:s.value.berat_badan[r],jarak_rumah_ke_sekolah:s.value.jarak_rumah_ke_sekolah[r],waktu_tempuh_ke_sekolah:s.value.waktu_tempuh_ke_sekolah[r],menit_tempuh_ke_sekolah:s.value.menit_tempuh_ke_sekolah[r],jumlah_saudara_kandung:s.value.jumlah_saudara_kandung[r]},async onResponse({response:l}){var k,c,e,n,P,B;console.log(s.value.tinggi_badan[r]);const a=l._data;h.value[r]=!1,u.value.tinggi_badan[r]=((k=a.errors)==null?void 0:k.tinggi_badan)??void 0,u.value.berat_badan[r]=((c=a.errors)==null?void 0:c.berat_badan)??void 0,u.value.jarak_rumah_ke_sekolah[r]=((e=a.errors)==null?void 0:e.jarak_rumah_ke_sekolah)??void 0,u.value.waktu_tempuh_ke_sekolah[r]=((n=a.errors)==null?void 0:n.waktu_tempuh_ke_sekolah)??void 0,u.value.menit_tempuh_ke_sekolah[r]=((P=a.errors)==null?void 0:P.menit_tempuh_ke_sekolah)??void 0,u.value.jumlah_saudara_kandung[r]=((B=a.errors)==null?void 0:B.jumlah_saudara_kandung)??void 0,a.errors||(g.value=!0)}})};return(r,l)=>{const a=I,k=E,c=X("RouterLink");return t(f)?(b(),x(j,{key:0,class:"text-center"},{default:o(()=>[i(Y,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(b(),W(H,{key:1},[t(v)?(b(),x(j,{key:0},{default:o(()=>[i(M,{class:"pb-4"},{default:o(()=>[i(q,null,{default:o(()=>l[4]||(l[4]=[m("Data Periodik Siswa")])),_:1,__:[4]})]),_:1}),i(z),i(K,{class:"d-flex flex-wrap gap-4"},{default:o(()=>[p("div",se,[i(a,{modelValue:t(d).itemsPerPage,"onUpdate:modelValue":l[0]||(l[0]=e=>t(d).itemsPerPage=e),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),i(ae),p("div",re,[i(k,{modelValue:t(d).searchQuery,"onUpdate:modelValue":l[1]||(l[1]=e=>t(d).searchQuery=e),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),i(z),i(te,{page:t(d).page,"onUpdate:page":l[2]||(l[2]=e=>t(d).page=e),"items-per-page":t(d).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:t(y),"server-items-length":t(w),"items-length":t(w),headers:L,"items-per-page-text":"Item",options:t(d),loading:t(V),"loading-text":"Loading...","onUpdate:sortBy":Q,"header-props":{class:"text-no-wrap"}},{"header.waktu":o(({item:e})=>l[5]||(l[5]=[m(" Waktu Tempuh "),p("br",null,null,-1),m(" Jam | Menit ")])),"header.saudara":o(({item:e})=>l[6]||(l[6]=[m(" Jml Saudara "),p("br",null,null,-1),m(" Kandung ")])),"item.nama":o(({item:e})=>{var n;return[p("div",oe,[p("div",ie,[p("h6",ne,S(e.nama),1),p("div",de,S((n=e.kelas)==null?void 0:n.nama),1)])])]}),"item.kelas":o(({item:e})=>{var n;return[m(S((n=e.kelas)==null?void 0:n.nama),1)]}),"item.tinggi":o(({item:e})=>[i(k,{modelValue:t(s).tinggi_badan[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).tinggi_badan[e.peserta_didik_id]=n,"error-messages":t(u).tinggi_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.berat":o(({item:e})=>[i(k,{modelValue:t(s).berat_badan[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).berat_badan[e.peserta_didik_id]=n,"error-messages":t(u).berat_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.jarak":o(({item:e})=>[i(a,{items:[{title:"Kurang dari 1 KM",value:"1"},{title:"Lebih dari 1 KM",value:"2"}],modelValue:t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id]=n,"error-messages":t(u).jarak_rumah_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"10rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.waktu":o(({item:e})=>[i(le,null,{default:o(()=>[i(N,{cols:"12",sm:"6"},{default:o(()=>[i(k,{modelValue:t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id]=n,"error-messages":t(u).waktu_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024),i(N,{cols:"12",sm:"6"},{default:o(()=>[i(k,{modelValue:t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id]=n,"error-messages":t(u).menit_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024)]),_:2},1024)]),"item.saudara":o(({item:e})=>[i(k,{modelValue:t(s).jumlah_saudara_kandung[e.peserta_didik_id],"onUpdate:modelValue":n=>t(s).jumlah_saudara_kandung[e.peserta_didik_id]=n,"error-messages":t(u).jumlah_saudara_kandung[e.peserta_didik_id],style:{"inline-size":"5rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.aksi":o(({item:e})=>[i(Z,{size:"small",onClick:n=>A(e.peserta_didik_id),disabled:t(h)[e.peserta_didik_id],loading:t(h)[e.peserta_didik_id]},{default:o(()=>l[7]||(l[7]=[m("Simpan")])),_:2,__:[7]},1032,["onClick","disabled","loading"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"])]),_:1})):(b(),x(j,{key:1,color:"#007BB6"},{default:o(()=>[i(K,null,{default:o(()=>[p("p",ue,[l[9]||(l[9]=m(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),i(c,{class:"text-success ms-1",to:{name:"root"}},{default:o(()=>l[8]||(l[8]=[m(" disini ")])),_:1,__:[8]})])]),_:1})]),_:1})),i(F,{modelValue:t(g),"onUpdate:modelValue":l[3]||(l[3]=e=>G(g)?g.value=e:null),color:"success",location:"top end"},{default:o(()=>l[10]||(l[10]=[m(" Data Periodik berhasil disimpan. ")])),_:1,__:[10]},8,["modelValue"])],64))}}};export{Ne as default};
