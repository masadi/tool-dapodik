import{V as A,r as _}from"./VForm-BCFecV4T.js";import{E,r as c,c as q,f as u,b as n,l,e as r,F as P,a2 as N,a as j,o as s,ay as I,s as h,$ as M,h as W,d as R,t as O,k as g,a0 as Y,ax as z}from"./main-DGJYvYAg.js";import{_ as J}from"./AppAutocomplete-BF1sZwxj.js";import{V as G,_ as H}from"./VSnackbar-D6uEjFBD.js";import{_ as Q,i as X}from"./id-5GBVTTPT.js";import{_ as Z}from"./AppTextField-jRXrPS0L.js";import{u as aa}from"./useApi-BXPsAmwb.js";import{c as ea}from"./createUrl-DU1TYGZs.js";import{$ as C}from"./api-CJUytNDg.js";import{V as x,a as ta,b as la}from"./VCard-d_GfuFdO.js";import{V as na}from"./VDivider-BF8TmWRV.js";import{V as F}from"./VCardText-UP7RgOAt.js";import{V as b,a as m}from"./VRow-Bc7GsW2h.js";import"./VTextField--NeGP0V7.js";import"./VImg-BJ5H3kLx.js";import"./forwardRefs-DQ2Rjf1x.js";import"./VList-BVfFfe_O.js";import"./VAvatar-CIwYu2sc.js";import"./VMenu-CMCRuz7M.js";import"./VChip-EjRDrGE3.js";import"./index-CvOPxmL5.js";/* empty css              */const ra=["for"],oa={class:"clamp-text text-white mb-0"},Ra={__name:"tambah-ptk",setup(ia){E(async()=>{await K()});const w=c(!1),U=c(),K=async()=>{w.value=!0;try{let t=(await aa(ea("/cek-sekolah",{query:{ptk:1}}))).data.value;U.value=t.sekolah;const d=v.value.find(p=>p.id==="provinsi_id");d.items=t.wilayah}catch(e){console.error(e)}finally{w.value=!1}},D={dateFormat:"Y-m-d",locale:X.Indonesian,altFormat:"j F Y",altInput:!0},f=c(!1),T=c(),o=c({nama:null,nik:null,jenis_kelamin:null,tempat_lahir:null,tanggal_lahir:null,provinsi_id:null,kabupaten_id:null,kecamatan_id:null,rt:null,rw:null,alamat_jalan:null,desa_kelurahan:null,email:null,nama_ibu_kandung:null,status_perkawinan:null,sk_pengangkatan:null,tmt_pengangkatan:null}),v=c([{id:"nama",nama:"Nama",type:"text"},{id:"nik",nama:"NIK",type:"text"},{id:"jenis_kelamin",nama:"Jenis Kelamin",type:"select",items:[{title:"Laki-laki",value:"L"},{title:"Perempuan",value:"P"}]},{id:"tempat_lahir",nama:"Tempat Lahir",type:"text"},{id:"tanggal_lahir",nama:"Tanggal Lahir",type:"date"},{id:"provinsi_id",nama:"Provinsi",type:"wilayah",items:[]},{id:"kabupaten_id",nama:"Kabupaten/Kota",type:"wilayah",items:[]},{id:"kecamatan_id",nama:"Kecamatan",type:"wilayah",items:[]},{id:"rt_rw",nama:"RT/RW",type:"rt_rw"},{id:"alamat_jalan",nama:"Alamat",type:"text"},{id:"desa_kelurahan",nama:"Desa/Kelurahan",type:"text"},{id:"email",nama:"Email",type:"text"},{id:"nama_ibu_kandung",nama:"Nama Ibu Kandung",type:"text"},{id:"status_perkawinan",nama:"Status Perkawinan",type:"select",items:[{title:"Belum",value:1},{title:"Sudah",value:2}]},{id:"sk_pengangkatan",nama:"SK Pengangkatan",type:"text"},{id:"tmt_pengangkatan",nama:"TMT",type:"date"}]),S=c({nik:void 0}),$=async()=>{try{const e=await C("/tambah-ptk",{method:"POST",body:o.value,onResponseError({response:t}){S.value=t._data.errors}});console.log(e),f.value=!0,await z(()=>{o.value.tanggal_lahir=null,o.value.tmt_pengangkatan=null,T.value.reset(),console.log("reset Form")})}catch(e){console.error(e)}},B=()=>{var e;(e=T.value)==null||e.validate().then(({valid:t})=>{t&&$()})},L=async(e,t)=>{let d;e=="provinsi_id"?d="kabupaten":d="kecamatan",await C("/wilayah",{method:"POST",body:{cari:d,kode_wilayah:t},onResponseError({response:p}){S.value=p._data.errors},onResponse({response:p}){let k=p._data;if(k.length)if(e=="provinsi_id"){const V=v.value.find(y=>y.id==="kabupaten_id");V.items=k}else{const V=v.value.find(y=>y.id==="kecamatan_id");V.items=k}}})};return(e,t)=>{const d=Z,p=Q,k=H,V=J,y=j("RouterLink");return s(),q(P,null,[l(w)?(s(),u(x,{key:0,class:"text-center"},{default:r(()=>[n(I,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(s(),q(P,{key:1},[l(U)?(s(),u(x,{key:0},{default:r(()=>[n(ta,{class:"pb-4"},{default:r(()=>[n(la,null,{default:r(()=>t[3]||(t[3]=[h("Tambah PTK")])),_:1,__:[3]})]),_:1}),n(na),n(A,{ref_key:"refVForm",ref:T,onSubmit:M(B,["prevent"])},{default:r(()=>[n(F,null,{default:r(()=>[n(b,null,{default:r(()=>[(s(!0),q(P,null,W(l(v),a=>(s(),u(m,{cols:"12"},{default:r(()=>[n(b,{"no-gutters":""},{default:r(()=>[n(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>[R("label",{class:"v-label text-body-2 text-high-emphasis",for:a.id},O(a.nama),9,ra)]),_:2},1024),n(m,{cols:"12",md:"9"},{default:r(()=>[a.type=="text"?(s(),u(d,{key:0,id:a.id,modelValue:l(o)[a.id],"onUpdate:modelValue":i=>l(o)[a.id]=i,rules:["requiredValidator"in e?e.requiredValidator:l(_)],placeholder:a.nama,"error-messages":l(S)[a.id],"persistent-placeholder":""},null,8,["id","modelValue","onUpdate:modelValue","rules","placeholder","error-messages"])):g("",!0),a.type=="date"?(s(),u(p,{key:1,id:a.id,modelValue:l(o)[a.id],"onUpdate:modelValue":i=>l(o)[a.id]=i,rules:["requiredValidator"in e?e.requiredValidator:l(_)],placeholder:"== Pilih Tanggal ==",config:D},null,8,["id","modelValue","onUpdate:modelValue","rules"])):g("",!0),a.type=="rt_rw"?(s(),u(b,{key:2,"no-gutters":""},{default:r(()=>[n(m,{cols:"6"},{default:r(()=>[n(d,{id:a.id,modelValue:l(o).rt,"onUpdate:modelValue":t[0]||(t[0]=i=>l(o).rt=i),rules:["requiredValidator"in e?e.requiredValidator:l(_)],placeholder:"RT","persistent-placeholder":"",class:"me-1"},null,8,["id","modelValue","rules"])]),_:2},1024),n(m,{cols:"6"},{default:r(()=>[n(d,{id:a.id,modelValue:l(o).rw,"onUpdate:modelValue":t[1]||(t[1]=i=>l(o).rw=i),rules:["requiredValidator"in e?e.requiredValidator:l(_)],placeholder:"RW","persistent-placeholder":"",class:"ms-1"},null,8,["id","modelValue","rules"])]),_:2},1024)]),_:2},1024)):g("",!0),a.type=="select"?(s(),u(k,{key:3,id:a.id,modelValue:l(o)[a.id],"onUpdate:modelValue":i=>l(o)[a.id]=i,rules:["requiredValidator"in e?e.requiredValidator:l(_)],items:a.items,placeholder:`Pilih ${a.nama}`},null,8,["id","modelValue","onUpdate:modelValue","rules","items","placeholder"])):g("",!0),a.type=="wilayah"?(s(),u(V,{key:4,id:a.id,modelValue:l(o)[a.id],"onUpdate:modelValue":[i=>l(o)[a.id]=i,i=>L(a.id,i)],rules:["requiredValidator"in e?e.requiredValidator:l(_)],items:a.items,placeholder:`Pilih ${a.nama}`,"item-title":"nama","item-value":"kode_wilayah"},null,8,["id","modelValue","onUpdate:modelValue","rules","items","placeholder"])):g("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),n(m,{cols:"12"},{default:r(()=>[n(b,{"no-gutters":""},{default:r(()=>[n(m,{cols:"12",md:"3"}),n(m,{cols:"12",md:"9"},{default:r(()=>[n(Y,{type:"submit",class:"me-4"},{default:r(()=>t[4]||(t[4]=[h(" Simpan ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})):(s(),u(x,{key:1,color:"#007BB6"},{default:r(()=>[n(F,null,{default:r(()=>[R("p",oa,[t[6]||(t[6]=h(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),n(y,{class:"text-success ms-1",to:{name:"root"}},{default:r(()=>t[5]||(t[5]=[h(" disini ")])),_:1,__:[5]})])]),_:1})]),_:1}))],64)),n(G,{modelValue:l(f),"onUpdate:modelValue":t[2]||(t[2]=a=>N(f)?f.value=a:null),color:"success",location:"top end"},{default:r(()=>t[7]||(t[7]=[h(" PTK baru berhasil disimpan. ")])),_:1,__:[7]},8,["modelValue"])],64)}}};export{Ra as default};
