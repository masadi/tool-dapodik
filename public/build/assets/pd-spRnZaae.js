import{_ as A}from"./AppTextField-CV_Cpl28.js";import{V as E,_ as F,a as I}from"./VSnackbar-C7OO63mo.js";import{u as B}from"./useApi-c-D3pQq5.js";import{c as C}from"./VTable-BdDhpBOz.js";import{$ as J}from"./api-6BZlYoCD.js";import{V as j,a as M,b as q}from"./VCard-C5r7PErk.js";import{E as O,r as _,w as D,f as x,c as W,l as a,e as i,b as o,a2 as G,F as H,a as X,o as c,ay as Y,s as m,d as p,a0 as Z,t as ee,az as ae}from"./main-4hhcoTnx.js";import{V as T}from"./VDivider-rVIt_vZr.js";import{V as z}from"./VCardText-DkC9YI9k.js";import{V as te}from"./VSpacer-CyRyHIW8.js";import{V as le,a as K}from"./VRow-k-2RrWpH.js";import"./VTextField-BWQb-rx5.js";import"./VImg-BdP77FH8.js";import"./forwardRefs-BKtaBFVq.js";import"./VDataTable-CtluMcmd.js";import"./VChip-D23iua3i.js";import"./VAvatar-B-XCWvkX.js";import"./VList-VacgUzEu.js";import"./VMenu-DfT4s1bt.js";import"./index-CvOPxmL5.js";/* empty css              */const se={class:"d-flex gap-2 align-center"},re={class:"d-flex align-center flex-wrap gap-4"},oe={class:"clamp-text text-white mb-0"},Be={__name:"pd",setup(ie){O(async()=>{await N()});const f=_(!1),v=_(),N=async()=>{f.value=!0;try{let t=(await B(C("/cek-sekolah"))).data.value;v.value=t.sekolah,s.value.semester_id=t.semester.semester_id,v.value&&S()}catch(r){console.error(r)}finally{f.value=!1}},R=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"NISN",key:"nisn",align:"center"},{title:"Kelas",key:"kelas",align:"center",sortable:!1},{title:"Tinggi Badan",key:"tinggi",sortable:!1},{title:"Berat Badan",key:"berat",align:"center",sortable:!1},{title:"Jarak",key:"jarak",align:"center",sortable:!1},{title:"waktu",key:"waktu",align:"center",sortable:!1},{title:"Jml Saudara Kandung",key:"saudara",align:"center",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],n=_({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"nama",sortbydesc:"ASC"}),V=_(!1),y=_([]),w=_(0),L=r=>{var t,l;n.value.sortby=(t=r[0])==null?void 0:t.key,n.value.sortbydesc=(l=r[0])==null?void 0:l.order},s=_({semester_id:null,tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),g=_(!1),S=async()=>{V.value=!0;try{let t=(await B(C("/periodik",{query:{q:n.value.searchQuery,page:n.value.page,per_page:n.value.itemsPerPage,sortby:n.value.sortby,sortbydesc:n.value.sortbydesc}}))).data.value;y.value=t.data.data,w.value=t.data.total,y.value.forEach(l=>{s.value.tinggi_badan[l.peserta_didik_id]=l.periodik?l.periodik.tinggi_badan:null,s.value.berat_badan[l.peserta_didik_id]=l.periodik?l.periodik.berat_badan:null,s.value.jarak_rumah_ke_sekolah[l.peserta_didik_id]=l.periodik?l.periodik.jarak_rumah_ke_sekolah:null,s.value.waktu_tempuh_ke_sekolah[l.peserta_didik_id]=l.periodik?l.periodik.waktu_tempuh_ke_sekolah:null,s.value.menit_tempuh_ke_sekolah[l.peserta_didik_id]=l.periodik?l.periodik.menit_tempuh_ke_sekolah:null,s.value.jumlah_saudara_kandung[l.peserta_didik_id]=l.periodik?l.periodik.jumlah_saudara_kandung:null})}catch(r){console.error(r)}finally{V.value=!1}};D(n,ae(()=>{S()},500),{deep:!0}),D(()=>n.value.searchQuery,()=>{n.value.page=1});const h=_([]),Q=_(),u=_({tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),$=async r=>{Q.value=r,h.value[r]=!0,await J("/periodik",{method:"POST",body:{semester_id:s.value.semester_id,peserta_didik_id:r,tinggi_badan:s.value.tinggi_badan[r],berat_badan:s.value.berat_badan[r],jarak_rumah_ke_sekolah:s.value.jarak_rumah_ke_sekolah[r],waktu_tempuh_ke_sekolah:s.value.waktu_tempuh_ke_sekolah[r],menit_tempuh_ke_sekolah:s.value.menit_tempuh_ke_sekolah[r],jumlah_saudara_kandung:s.value.jumlah_saudara_kandung[r]},async onResponse({response:t}){var k,b,e,d,U,P;console.log(s.value.tinggi_badan[r]);const l=t._data;h.value[r]=!1,u.value.tinggi_badan[r]=((k=l.errors)==null?void 0:k.tinggi_badan)??void 0,u.value.berat_badan[r]=((b=l.errors)==null?void 0:b.berat_badan)??void 0,u.value.jarak_rumah_ke_sekolah[r]=((e=l.errors)==null?void 0:e.jarak_rumah_ke_sekolah)??void 0,u.value.waktu_tempuh_ke_sekolah[r]=((d=l.errors)==null?void 0:d.waktu_tempuh_ke_sekolah)??void 0,u.value.menit_tempuh_ke_sekolah[r]=((U=l.errors)==null?void 0:U.menit_tempuh_ke_sekolah)??void 0,u.value.jumlah_saudara_kandung[r]=((P=l.errors)==null?void 0:P.jumlah_saudara_kandung)??void 0,l.errors||(g.value=!0)}})};return(r,t)=>{const l=F,k=A,b=X("RouterLink");return a(f)?(c(),x(j,{key:0,class:"text-center"},{default:i(()=>[o(Y,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(c(),W(H,{key:1},[a(v)?(c(),x(j,{key:0},{default:i(()=>[o(M,{class:"pb-4"},{default:i(()=>[o(q,null,{default:i(()=>t[4]||(t[4]=[m("Data Periodik Siswa")])),_:1,__:[4]})]),_:1}),o(T),o(z,{class:"d-flex flex-wrap gap-4"},{default:i(()=>[p("div",se,[o(l,{modelValue:a(n).itemsPerPage,"onUpdate:modelValue":t[0]||(t[0]=e=>a(n).itemsPerPage=e),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),o(te),p("div",re,[o(k,{modelValue:a(n).searchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>a(n).searchQuery=e),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),o(T),o(I,{page:a(n).page,"onUpdate:page":t[2]||(t[2]=e=>a(n).page=e),"items-per-page":a(n).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:a(y),"server-items-length":a(w),"items-length":a(w),headers:R,"items-per-page-text":"Item",options:a(n),loading:a(V),"loading-text":"Loading...","onUpdate:sortBy":L,"header-props":{class:"text-no-wrap"}},{"header.waktu":i(({item:e})=>t[5]||(t[5]=[m(" Waktu Tempuh "),p("br",null,null,-1),m(" Jam | Menit ")])),"header.saudara":i(({item:e})=>t[6]||(t[6]=[m(" Jml Saudara "),p("br",null,null,-1),m(" Kandung ")])),"item.kelas":i(({item:e})=>{var d;return[m(ee((d=e.kelas)==null?void 0:d.nama),1)]}),"item.tinggi":i(({item:e})=>[o(k,{modelValue:a(s).tinggi_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).tinggi_badan[e.peserta_didik_id]=d,"error-messages":a(u).tinggi_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.berat":i(({item:e})=>[o(k,{modelValue:a(s).berat_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).berat_badan[e.peserta_didik_id]=d,"error-messages":a(u).berat_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.jarak":i(({item:e})=>[o(l,{items:[{title:"Kurang dari 1 KM",value:"1"},{title:"Lebih dari 1 KM",value:"2"}],modelValue:a(s).jarak_rumah_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).jarak_rumah_ke_sekolah[e.peserta_didik_id]=d,"error-messages":a(u).jarak_rumah_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"10rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.waktu":i(({item:e})=>[o(le,null,{default:i(()=>[o(K,{cols:"12",sm:"6"},{default:i(()=>[o(k,{modelValue:a(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":a(u).waktu_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024),o(K,{cols:"12",sm:"6"},{default:i(()=>[o(k,{modelValue:a(s).menit_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).menit_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":a(u).menit_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024)]),_:2},1024)]),"item.saudara":i(({item:e})=>[o(k,{modelValue:a(s).jumlah_saudara_kandung[e.peserta_didik_id],"onUpdate:modelValue":d=>a(s).jumlah_saudara_kandung[e.peserta_didik_id]=d,"error-messages":a(u).jumlah_saudara_kandung[e.peserta_didik_id],style:{"inline-size":"5rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.aksi":i(({item:e})=>[o(Z,{size:"small",onClick:d=>$(e.peserta_didik_id),disabled:a(h)[e.peserta_didik_id],loading:a(h)[e.peserta_didik_id]},{default:i(()=>t[7]||(t[7]=[m("Simpan")])),_:2,__:[7]},1032,["onClick","disabled","loading"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"])]),_:1})):(c(),x(j,{key:1,color:"#007BB6"},{default:i(()=>[o(z,null,{default:i(()=>[p("p",oe,[t[9]||(t[9]=m(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),o(b,{class:"text-success ms-1",to:{name:"root"}},{default:i(()=>t[8]||(t[8]=[m(" disini ")])),_:1,__:[8]})])]),_:1})]),_:1})),o(E,{modelValue:a(g),"onUpdate:modelValue":t[3]||(t[3]=e=>G(g)?g.value=e:null),color:"success",location:"top end"},{default:i(()=>t[10]||(t[10]=[m(" Data Periodik berhasil disimpan. ")])),_:1,__:[10]},8,["modelValue"])],64))}}};export{Be as default};
