import{_ as E}from"./AppTextField-CqS6XxL3.js";import{V as F,_ as I}from"./VSnackbar-CTGQaDNw.js";import{u as B}from"./useApi-DwkuwgPt.js";import{c as D}from"./createUrl-CajvBFNI.js";import{$ as J}from"./api-BHR1kc2J.js";import{V as x,a as M,b as q}from"./VCard-D3TbuSm7.js";import{E as O,r as _,w as C,f as j,c as W,l as t,e as i,b as o,a2 as G,F as H,a as X,o as b,ay as Y,s as p,d as m,a0 as Z,t as T,az as ee}from"./main-BsmKIk5B.js";import{V as z}from"./VDivider-BEdtlgfd.js";import{V as N}from"./VCardText-CjP1xKPx.js";import{V as K}from"./VSpacer-BDyaa2P0.js";import{V as ae}from"./VDataTableServer-D4sKFXOa.js";import"./VTextField-DI4LfYYa.js";import"./VImg-Drlr6qiy.js";import"./forwardRefs-Ch159O2S.js";import"./VList-Rn59Z0oY.js";import"./VAvatar-C3dDoxo3.js";import"./VMenu-08bOKY_R.js";import"./VChip-z02X1wyY.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VDataTable-dizaDpfc.js";import"./VTable-DCrKNSXc.js";const te={class:"d-flex gap-2 align-center"},le={class:"d-flex align-center flex-wrap gap-4"},se={class:"d-flex align-center gap-x-4"},re={class:"d-flex flex-column"},oe={class:"text-base"},ie={class:"text-sm"},ne={class:"d-flex gap-2 align-center"},de={class:"clamp-text text-white mb-0"},ze={__name:"pd",setup(ue){O(async()=>{await L()});const v=_(!1),f=_(),L=async()=>{var r;v.value=!0;try{let a=(await B(D("/cek-sekolah"))).data.value;f.value=a.sekolah,s.value.semester_id=(r=a.semester)==null?void 0:r.semester_id,f.value&&S()}catch(l){console.error(l)}finally{v.value=!1}},Q=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"NISN",key:"nisn",align:"center"},{title:"Tinggi Badan",key:"tinggi",sortable:!1},{title:"Berat Badan",key:"berat",align:"center",sortable:!1},{title:"Jarak",key:"jarak",align:"center",sortable:!1},{title:"waktu",key:"waktu",align:"center",sortable:!1},{title:"Jml Saudara Kandung",key:"saudara",align:"center",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],n=_({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"nama",sortbydesc:"ASC"}),V=_(!1),y=_([]),w=_(0),R=r=>{var l,a;n.value.sortby=(l=r[0])==null?void 0:l.key,n.value.sortbydesc=(a=r[0])==null?void 0:a.order},s=_({semester_id:null,tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),g=_(!1),S=async()=>{V.value=!0;try{let l=(await B(D("/periodik",{query:{q:n.value.searchQuery,page:n.value.page,per_page:n.value.itemsPerPage,sortby:n.value.sortby,sortbydesc:n.value.sortbydesc}}))).data.value;y.value=l.data.data,w.value=l.data.total,y.value.forEach(a=>{s.value.tinggi_badan[a.peserta_didik_id]=a.periodik?a.periodik.tinggi_badan:null,s.value.berat_badan[a.peserta_didik_id]=a.periodik?a.periodik.berat_badan:null,s.value.jarak_rumah_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.jarak_rumah_ke_sekolah:null,s.value.waktu_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.waktu_tempuh_ke_sekolah:null,s.value.menit_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.menit_tempuh_ke_sekolah:null,s.value.jumlah_saudara_kandung[a.peserta_didik_id]=a.periodik?a.periodik.jumlah_saudara_kandung:null})}catch(r){console.error(r)}finally{V.value=!1}};C(n,ee(()=>{S()},500),{deep:!0}),C(()=>n.value.searchQuery,()=>{n.value.page=1});const h=_([]),$=_(),u=_({tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),A=async r=>{$.value=r,h.value[r]=!0,await J("/periodik",{method:"POST",body:{semester_id:s.value.semester_id,peserta_didik_id:r,tinggi_badan:s.value.tinggi_badan[r],berat_badan:s.value.berat_badan[r],jarak_rumah_ke_sekolah:s.value.jarak_rumah_ke_sekolah[r],waktu_tempuh_ke_sekolah:s.value.waktu_tempuh_ke_sekolah[r],menit_tempuh_ke_sekolah:s.value.menit_tempuh_ke_sekolah[r],jumlah_saudara_kandung:s.value.jumlah_saudara_kandung[r]},async onResponse({response:l}){var k,c,e,d,U,P;console.log(s.value.tinggi_badan[r]);const a=l._data;h.value[r]=!1,u.value.tinggi_badan[r]=((k=a.errors)==null?void 0:k.tinggi_badan)??void 0,u.value.berat_badan[r]=((c=a.errors)==null?void 0:c.berat_badan)??void 0,u.value.jarak_rumah_ke_sekolah[r]=((e=a.errors)==null?void 0:e.jarak_rumah_ke_sekolah)??void 0,u.value.waktu_tempuh_ke_sekolah[r]=((d=a.errors)==null?void 0:d.waktu_tempuh_ke_sekolah)??void 0,u.value.menit_tempuh_ke_sekolah[r]=((U=a.errors)==null?void 0:U.menit_tempuh_ke_sekolah)??void 0,u.value.jumlah_saudara_kandung[r]=((P=a.errors)==null?void 0:P.jumlah_saudara_kandung)??void 0,a.errors||(g.value=!0)}})};return(r,l)=>{const a=I,k=E,c=X("RouterLink");return t(v)?(b(),j(x,{key:0,class:"text-center"},{default:i(()=>[o(Y,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(b(),W(H,{key:1},[t(f)?(b(),j(x,{key:0},{default:i(()=>[o(M,{class:"pb-4"},{default:i(()=>[o(q,null,{default:i(()=>l[4]||(l[4]=[p("Data Periodik Siswa")])),_:1,__:[4]})]),_:1}),o(z),o(N,{class:"d-flex flex-wrap gap-4"},{default:i(()=>[m("div",te,[o(a,{modelValue:t(n).itemsPerPage,"onUpdate:modelValue":l[0]||(l[0]=e=>t(n).itemsPerPage=e),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),o(K),m("div",le,[o(k,{modelValue:t(n).searchQuery,"onUpdate:modelValue":l[1]||(l[1]=e=>t(n).searchQuery=e),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),o(z),o(ae,{page:t(n).page,"onUpdate:page":l[2]||(l[2]=e=>t(n).page=e),"items-per-page":t(n).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:t(y),"server-items-length":t(w),"items-length":t(w),headers:Q,"items-per-page-text":"Item",options:t(n),loading:t(V),"loading-text":"Loading...","onUpdate:sortBy":R,"header-props":{class:"text-no-wrap"}},{"header.waktu":i(({item:e})=>l[5]||(l[5]=[p(" Waktu Tempuh "),m("br",null,null,-1),p(" Jam | Menit ")])),"header.saudara":i(({item:e})=>l[6]||(l[6]=[p(" Jml Saudara "),m("br",null,null,-1),p(" Kandung ")])),"item.nama":i(({item:e})=>{var d;return[m("div",se,[m("div",re,[m("h6",oe,T(e.nama),1),m("div",ie,T((d=e.kelas)==null?void 0:d.nama),1)])])]}),"item.tinggi":i(({item:e})=>[o(k,{modelValue:t(s).tinggi_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).tinggi_badan[e.peserta_didik_id]=d,"error-messages":t(u).tinggi_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.berat":i(({item:e})=>[o(k,{modelValue:t(s).berat_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).berat_badan[e.peserta_didik_id]=d,"error-messages":t(u).berat_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.jarak":i(({item:e})=>[o(a,{items:[{title:"Kurang dari 1 KM",value:"1"},{title:"Lebih dari 1 KM",value:"2"}],modelValue:t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).jarak_rumah_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"10rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.waktu":i(({item:e})=>[m("div",ne,[o(k,{modelValue:t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).waktu_tempuh_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"4rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"]),o(K),o(k,{modelValue:t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).menit_tempuh_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"4rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])])]),"item.saudara":i(({item:e})=>[o(k,{modelValue:t(s).jumlah_saudara_kandung[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).jumlah_saudara_kandung[e.peserta_didik_id]=d,"error-messages":t(u).jumlah_saudara_kandung[e.peserta_didik_id],style:{"inline-size":"5rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.aksi":i(({item:e})=>[o(Z,{size:"small",onClick:d=>A(e.peserta_didik_id),disabled:t(h)[e.peserta_didik_id],loading:t(h)[e.peserta_didik_id]},{default:i(()=>l[7]||(l[7]=[p("Simpan")])),_:2,__:[7]},1032,["onClick","disabled","loading"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"])]),_:1})):(b(),j(x,{key:1,color:"#007BB6"},{default:i(()=>[o(N,null,{default:i(()=>[m("p",de,[l[9]||(l[9]=p(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),o(c,{class:"text-success ms-1",to:{name:"root"}},{default:i(()=>l[8]||(l[8]=[p(" disini ")])),_:1,__:[8]})])]),_:1})]),_:1})),o(F,{modelValue:t(g),"onUpdate:modelValue":l[3]||(l[3]=e=>G(g)?g.value=e:null),color:"success",location:"top end"},{default:i(()=>l[10]||(l[10]=[p(" Data Periodik berhasil disimpan. ")])),_:1,__:[10]},8,["modelValue"])],64))}}};export{ze as default};
