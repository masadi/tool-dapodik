import{a as L,f as m,o as d,e,b as l,Z as w,r as p,E as M,c as I,l as t,F as O,s as i,d as r,a0 as y,k as S,au as G,t as V,a2 as P}from"./main-DGJYvYAg.js";import{_ as K}from"./AppAutocomplete-BF1sZwxj.js";import{_ as Z}from"./JamSinkron-ByeglAj9.js";import{$ as U}from"./api-CJUytNDg.js";import{u as j,b as Q,a as W}from"./useApi-BXPsAmwb.js";import{c as A}from"./createUrl-DU1TYGZs.js";import{V as D,a as B,b as x}from"./VCard-d_GfuFdO.js";import{V as c}from"./VCardText-UP7RgOAt.js";import{V as X}from"./VAlert-BLHgW_T2.js";import{V as h}from"./VTable-7wceRrAn.js";import{V as aa}from"./VDialog-CjQAzH6L.js";import"./VTextField--NeGP0V7.js";import"./VImg-BJ5H3kLx.js";import"./forwardRefs-DQ2Rjf1x.js";import"./VList-BVfFfe_O.js";import"./VAvatar-CIwYu2sc.js";import"./VDivider-BF8TmWRV.js";import"./VMenu-CMCRuz7M.js";import"./VChip-EjRDrGE3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CvOPxmL5.js";const ea={__name:"DialogCloseBtn",props:{icon:{type:String,required:!1,default:"tabler-x"},iconSize:{type:String,required:!1,default:"20"}},setup(N){const s=N;return(_,u)=>{const g=L("IconBtn");return d(),m(g,{variant:"elevated",size:"30",ripple:!1,class:"v-dialog-close-btn"},{default:e(()=>[l(w,{icon:s.icon,size:s.iconSize},null,8,["icon","size"])]),_:1})}}},la={key:0,class:"ms-3"},Sa={__name:"index",setup(N){const s=p(!1),_=p(),u=p(),g=p([]),T=p(!0),z=p(!1),$=p(!1),Y=async()=>{var a;s.value=!0;const o=g.value.find(n=>n.sekolah_id===_.value);await U("/sekolah",{method:"POST",body:{sekolah_id:_.value,pengguna_id:(a=o==null?void 0:o.pengguna)==null?void 0:a.pengguna_id},async onResponse({response:n}){let C=n._data;T.value=C.allowed,await b()}})};M(async()=>{await b()});const v=p(!1),b=async()=>{var o;v.value=!0;try{let n=(await j(A("/sekolah"))).data.value;g.value=n.sekolah,u.value=(o=n.user)==null?void 0:o.sekolah,$.value=n.error,z.value=n.jam_sinkron,s.value=!1}catch(a){console.error(a)}finally{v.value=!1}},f=p(!1),q=()=>{f.value=!0},E=async()=>{s.value=!0,f.value=!1,await j(A("/reset")),s.value=!1,W()},F=async()=>{console.log("connectToDapo"),await Q(A("normalkan")),await b()},H=async o=>{console.log(o),await U("/sekolah",{method:"POST",body:{data:"yayasan",yayasan_id:o},async onResponse({response:a}){let n=a._data;console.log(n),await b()}})};return(o,a)=>{const n=Z,C=K,J=ea;return d(),I(O,null,[l(D,{color:"#007BB6"},{default:e(()=>[l(B,null,{prepend:e(()=>[l(w,{size:"1.9rem",color:"white",icon:"tabler-database"})]),default:e(()=>[l(x,{class:"text-white"},{default:e(()=>a[5]||(a[5]=[i(" Tool Dapodik ")])),_:1,__:[5]})]),_:1}),l(c,null,{default:e(()=>a[6]||(a[6]=[r("p",{class:"clamp-text text-white mb-0"},"Harap Gunakan dengan BIJAK!",-1)])),_:1,__:[6]})]),_:1}),t($)?(d(),m(D,{key:0,class:"mt-4"},{default:e(()=>[l(x,null,{default:e(()=>a[7]||(a[7]=[i(" Aplikasi tidak terhubung ke Database Dapodik! ")])),_:1,__:[7]}),l(B,null,{default:e(()=>[l(y,{block:"",size:"large",onClick:F},{default:e(()=>a[8]||(a[8]=[i("Hubungkan Aplikasi ke Database Dapodik")])),_:1,__:[8]})]),_:1})]),_:1})):(d(),m(D,{key:1,class:"mt-4"},{default:e(()=>[l(B,null,G({default:e(()=>[l(x,null,{default:e(()=>[i(V(t(u)?"Data":"Registrasi")+" Sekolah ",1)]),_:1})]),_:2},[t(u)?{name:"append",fn:e(()=>[l(y,{color:"error",onClick:q,loading:t(s),disabled:t(s)},{default:e(()=>a[9]||(a[9]=[i("Reset")])),_:1,__:[9]},8,["loading","disabled"])]),key:"0"}:void 0]),1024),t(T)?S("",!0):(d(),m(c,{key:0},{default:e(()=>[l(X,{color:"error"},{default:e(()=>a[10]||(a[10]=[i(" NPSN tidak terdaftar! ")])),_:1,__:[10]})]),_:1})),t(u)?(d(),m(c,{key:1},{default:e(()=>[l(h,null,{default:e(()=>{var k,R;return[r("tbody",null,[r("tr",null,[a[11]||(a[11]=r("td",null,"Nama",-1)),r("td",null,V(t(u).nama),1)]),r("tr",null,[a[12]||(a[12]=r("td",null,"NPSN",-1)),r("td",null,V(t(u).npsn),1)]),r("tr",null,[a[14]||(a[14]=r("td",null,"Yayasan",-1)),r("td",null,[i(V((k=t(u).yayasan)==null?void 0:k.nama)+" ",1),((R=t(u).yayasan)==null?void 0:R.soft_delete)=="1"?(d(),m(y,{key:0,color:"error",size:"small",class:"ms-4",onClick:a[0]||(a[0]=ta=>H(t(u).yayasan.yayasan_id))},{default:e(()=>[l(w,{start:"",icon:"tabler-restore"}),a[13]||(a[13]=i(" Restore Yayasan "))]),_:1,__:[13]})):S("",!0)])])])]}),_:1})]),_:1})):(d(),m(c,{key:2},{default:e(()=>[t(z)?(d(),m(n,{key:0})):(d(),m(C,{key:1,modelValue:t(_),"onUpdate:modelValue":a[1]||(a[1]=k=>P(_)?_.value=k:null),items:t(g),"item-title":"nama","item-value":"sekolah_id",placeholder:"Pilih Sekolah",disabled:t(v),loading:t(v)},{append:e(()=>[l(y,{icon:o.$vuetify.display.smAndDown,onClick:Y,loading:t(s),disabled:t(s)},{default:e(()=>[l(w,{icon:"tabler-device-floppy",color:"#fff",size:"22"}),o.$vuetify.display.mdAndUp?(d(),I("span",la,"Simpan")):S("",!0)]),_:1},8,["icon","loading","disabled"])]),_:1},8,["modelValue","items","disabled","loading"]))]),_:1})),l(aa,{modelValue:t(f),"onUpdate:modelValue":a[4]||(a[4]=k=>P(f)?f.value=k:null),persistent:"",class:"v-dialog-sm"},{default:e(()=>[l(J,{onClick:a[2]||(a[2]=k=>f.value=!t(f))}),l(D,{title:"Apakah Anda yakin?"},{default:e(()=>[l(c,null,{default:e(()=>a[15]||(a[15]=[i(" Tindakan ini akan mengambalikan Aplikasi ke awal! ")])),_:1,__:[15]}),l(c,{class:"d-flex justify-end gap-3 flex-wrap"},{default:e(()=>[l(y,{color:"secondary",variant:"tonal",onClick:a[3]||(a[3]=k=>f.value=!1)},{default:e(()=>a[16]||(a[16]=[i(" Batal ")])),_:1,__:[16]}),l(y,{onClick:E},{default:e(()=>a[17]||(a[17]=[i(" Yakin ")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))],64)}}};export{Sa as default};
