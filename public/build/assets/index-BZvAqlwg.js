import{a as J,f as d,o as r,e,b as t,Z as w,r as k,E as M,c as R,l,F as O,s,d as i,a0 as _,au as G,t as b,k as S,a2 as I}from"./main-Br94O4uD.js";import{_ as K}from"./JamSinkron-DRlnvDwO.js";import{_ as L}from"./AppAutocomplete-CIkfrKQz.js";import{$ as P}from"./api-DMxPhGhi.js";import{u as U,b as Z,a as Q}from"./useApi-DxkU7gHg.js";import{c as A,V as W}from"./VTable-C-F5J47J.js";import{V as D,a as B,b as x}from"./VCard-D0jX7e3e.js";import{V as y}from"./VCardText-BCCnTFbg.js";import{V as X}from"./VAlert-DudU4kiO.js";import{V as h}from"./VDialog-DSxT4AUi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-DFLfwvaz.js";import"./VImg-C78O05wZ.js";import"./forwardRefs-D4ZWcY04.js";import"./VList-DXuBdEP1.js";import"./VAvatar-PzkRep2N.js";import"./VDivider-BRg69EUn.js";import"./VMenu-BrwQPZWv.js";import"./VChip-DAacyX-q.js";import"./index-CvOPxmL5.js";const aa={__name:"DialogCloseBtn",props:{icon:{type:String,required:!1,default:"tabler-x"},iconSize:{type:String,required:!1,default:"20"}},setup(N){const p=N;return(u,c)=>{const g=J("IconBtn");return r(),d(g,{variant:"elevated",size:"30",ripple:!1,class:"v-dialog-close-btn"},{default:e(()=>[t(w,{icon:p.icon,size:p.iconSize},null,8,["icon","size"])]),_:1})}}},ea={key:0,class:"ms-3"},wa={__name:"index",setup(N){const p=k(),u=k(),c=k([]),g=k(!0),T=k(!0),z=k(!1),j=async()=>{var a;const o=c.value.find(n=>n.sekolah_id===p.value);await P("/sekolah",{method:"POST",body:{sekolah_id:p.value,pengguna_id:(a=o==null?void 0:o.pengguna)==null?void 0:a.pengguna_id},async onResponse({response:n}){let C=n._data;g.value=C.allowed,await V()}})};M(async()=>{await V()});const v=k(!1),V=async()=>{var o;v.value=!0;try{let n=(await U(A("/sekolah"))).data.value;c.value=n.sekolah,u.value=(o=n.user)==null?void 0:o.sekolah,z.value=n.error,T.value=n.jam_sinkron}catch(a){console.error(a)}finally{v.value=!1}},m=k(!1),Y=()=>{m.value=!0},q=async()=>{m.value=!1,await U(A("/reset")),Q()},E=async()=>{console.log("connectToDapo"),await Z(A("normalkan")),await V()},F=async o=>{console.log(o),await P("/sekolah",{method:"POST",body:{data:"yayasan",yayasan_id:o},async onResponse({response:a}){let n=a._data;console.log(n),await V()}})};return(o,a)=>{const n=L,C=K,H=aa;return r(),R(O,null,[t(D,{color:"#007BB6"},{default:e(()=>[t(B,null,{prepend:e(()=>[t(w,{size:"1.9rem",color:"white",icon:"tabler-database"})]),default:e(()=>[t(x,{class:"text-white"},{default:e(()=>a[5]||(a[5]=[s(" Tool Dapodik ")])),_:1,__:[5]})]),_:1}),t(y,null,{default:e(()=>a[6]||(a[6]=[i("p",{class:"clamp-text text-white mb-0"},"Harap Gunakan dengan BIJAK!",-1)])),_:1,__:[6]})]),_:1}),l(z)?(r(),d(D,{key:0,class:"mt-4"},{default:e(()=>[t(x,null,{default:e(()=>a[7]||(a[7]=[s(" Aplikasi tidak terhubung ke Database Dapodik! ")])),_:1,__:[7]}),t(B,null,{default:e(()=>[t(_,{block:"",size:"large",onClick:E},{default:e(()=>a[8]||(a[8]=[s("Hubungkan Aplikasi ke Database Dapodik")])),_:1,__:[8]})]),_:1})]),_:1})):(r(),d(D,{key:1,class:"mt-4"},{default:e(()=>[t(B,null,G({default:e(()=>[t(x,null,{default:e(()=>[s(b(l(u)?"Data":"Registrasi")+" Sekolah ",1)]),_:1})]),_:2},[l(u)?{name:"append",fn:e(()=>[t(_,{color:"error",onClick:Y},{default:e(()=>a[9]||(a[9]=[s("Reset")])),_:1,__:[9]})]),key:"0"}:void 0]),1024),l(u)?(r(),d(y,{key:0},{default:e(()=>[l(g)?S("",!0):(r(),d(X,{key:0,color:"error"},{default:e(()=>a[10]||(a[10]=[s(" NPSN tidak terdaftar! ")])),_:1,__:[10]})),t(W,null,{default:e(()=>{var f,$;return[i("tbody",null,[i("tr",null,[a[11]||(a[11]=i("td",null,"Nama",-1)),i("td",null,b(l(u).nama),1)]),i("tr",null,[a[12]||(a[12]=i("td",null,"NPSN",-1)),i("td",null,b(l(u).npsn),1)]),i("tr",null,[a[14]||(a[14]=i("td",null,"Yayasan",-1)),i("td",null,[s(b((f=l(u).yayasan)==null?void 0:f.nama)+" ",1),(($=l(u).yayasan)==null?void 0:$.soft_delete)=="1"?(r(),d(_,{key:0,color:"error",size:"small",class:"ms-4",onClick:a[0]||(a[0]=ta=>F(l(u).yayasan.yayasan_id))},{default:e(()=>[t(w,{start:"",icon:"tabler-restore"}),a[13]||(a[13]=s(" Restore Yayasan "))]),_:1,__:[13]})):S("",!0)])])])]}),_:1})]),_:1})):(r(),d(y,{key:1},{default:e(()=>[l(T)?(r(),d(n,{key:0,modelValue:l(p),"onUpdate:modelValue":a[1]||(a[1]=f=>I(p)?p.value=f:null),items:l(c),"item-title":"nama","item-value":"sekolah_id",placeholder:"Pilih Sekolah",disabled:l(v),loading:l(v)},{append:e(()=>[t(_,{icon:o.$vuetify.display.smAndDown,onClick:j},{default:e(()=>[t(w,{icon:"tabler-device-floppy",color:"#fff",size:"22"}),o.$vuetify.display.mdAndUp?(r(),R("span",ea,"Simpan")):S("",!0)]),_:1},8,["icon"])]),_:1},8,["modelValue","items","disabled","loading"])):(r(),d(C,{key:1}))]),_:1})),t(h,{modelValue:l(m),"onUpdate:modelValue":a[4]||(a[4]=f=>I(m)?m.value=f:null),persistent:"",class:"v-dialog-sm"},{default:e(()=>[t(H,{onClick:a[2]||(a[2]=f=>m.value=!l(m))}),t(D,{title:"Apakah Anda yakin?"},{default:e(()=>[t(y,null,{default:e(()=>a[15]||(a[15]=[s(" Tindakan ini akan mengambalikan Aplikasi ke awal! ")])),_:1,__:[15]}),t(y,{class:"d-flex justify-end gap-3 flex-wrap"},{default:e(()=>[t(_,{color:"secondary",variant:"tonal",onClick:a[3]||(a[3]=f=>m.value=!1)},{default:e(()=>a[16]||(a[16]=[s(" Batal ")])),_:1,__:[16]}),t(_,{onClick:q},{default:e(()=>a[17]||(a[17]=[s(" Yakin ")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))],64)}}};export{wa as default};
