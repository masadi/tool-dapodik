import{V as j,r as c}from"./VForm-C3PSoVWU.js";import{E as A,r as _,c as S,b as n,e as r,a2 as D,l as t,F as U,o as s,s as T,$ as E,f as m,h as N,d as B,t as L,k as g,a0 as I,ax as M}from"./main-OoLoxX-r.js";import{_ as W}from"./AppAutocomplete-DEuwg-Df.js";import{V as J,_ as O}from"./VSnackbar-CrzjDMzH.js";import{_ as Y,i as z}from"./id-CEqENaBE.js";import{_ as G}from"./AppTextField-T_tTqbjb.js";import{_ as H}from"./JamSinkron-CTLdWVIr.js";import{u as Q}from"./useApi-eaZ1i750.js";import{c as X}from"./createUrl-D7bkMojZ.js";import{$ as F}from"./api-JxAF29fu.js";import{V as Z,a as aa,b as ea}from"./VCard-KeYi-ZKL.js";import{V as ta}from"./VDivider-BMLKyz-1.js";import{V as la}from"./VCardText-CHv2tAUD.js";import{V as v,a as u}from"./VRow-D-wJ9K9z.js";import"./VTextField-B8XRdwas.js";import"./VImg-pmx_lJPU.js";import"./forwardRefs-BkSc2fDr.js";import"./VList-CalgKRfT.js";import"./VAvatar-uA3QHqLd.js";import"./VMenu-Dtt2xTAl.js";import"./VChip-AM9lteTC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VAlert-BdmZ-uJK.js";import"./index-CvOPxmL5.js";/* empty css              */const na=["for"],xa={__name:"tambah-ptk",setup(ra){A(async()=>{await K()});const q=_(!1),P=_(!1),K=async()=>{q.value=!0;try{let l=(await Q(X("/cek-sekolah",{query:{ptk:1}}))).data.value;P.value=l.jam_sinkron;const p=f.value.find(d=>d.id==="provinsi_id");p.items=l.wilayah}catch(e){console.error(e)}finally{q.value=!1}},x={dateFormat:"Y-m-d",locale:z.Indonesian,altFormat:"j F Y",altInput:!0},h=_(!1),b=_(),i=_({nama:null,nik:null,jenis_kelamin:null,tempat_lahir:null,tanggal_lahir:null,provinsi_id:null,kabupaten_id:null,kecamatan_id:null,rt:null,rw:null,alamat_jalan:null,desa_kelurahan:null,email:null,nama_ibu_kandung:null,status_perkawinan:null,sk_pengangkatan:null,tmt_pengangkatan:null}),f=_([{id:"nama",nama:"Nama",type:"text"},{id:"nik",nama:"NIK",type:"text"},{id:"jenis_kelamin",nama:"Jenis Kelamin",type:"select",items:[{title:"Laki-laki",value:"L"},{title:"Perempuan",value:"P"}]},{id:"tempat_lahir",nama:"Tempat Lahir",type:"text"},{id:"tanggal_lahir",nama:"Tanggal Lahir",type:"date"},{id:"provinsi_id",nama:"Provinsi",type:"wilayah",items:[]},{id:"kabupaten_id",nama:"Kabupaten/Kota",type:"wilayah",items:[]},{id:"kecamatan_id",nama:"Kecamatan",type:"wilayah",items:[]},{id:"rt_rw",nama:"RT/RW",type:"rt_rw"},{id:"alamat_jalan",nama:"Alamat",type:"text"},{id:"desa_kelurahan",nama:"Desa/Kelurahan",type:"text"},{id:"email",nama:"Email",type:"text"},{id:"nama_ibu_kandung",nama:"Nama Ibu Kandung",type:"text"},{id:"status_perkawinan",nama:"Status Perkawinan",type:"select",items:[{title:"Belum",value:1},{title:"Sudah",value:2}]},{id:"sk_pengangkatan",nama:"SK Pengangkatan",type:"text"},{id:"tmt_pengangkatan",nama:"TMT",type:"date"}]),w=_({nik:void 0}),R=async()=>{try{const e=await F("/tambah-ptk",{method:"POST",body:i.value,onResponseError({response:l}){w.value=l._data.errors}});console.log(e),h.value=!0,await M(()=>{i.value.tanggal_lahir=null,i.value.tmt_pengangkatan=null,b.value.reset(),console.log("reset Form")})}catch(e){console.error(e)}},$=()=>{var e;(e=b.value)==null||e.validate().then(({valid:l})=>{l&&R()})},C=async(e,l)=>{let p;e=="provinsi_id"?p="kabupaten":p="kecamatan",await F("/wilayah",{method:"POST",body:{cari:p,kode_wilayah:l},onResponseError({response:d}){w.value=d._data.errors},onResponse({response:d}){let V=d._data;if(V.length)if(e=="provinsi_id"){const k=f.value.find(y=>y.id==="kabupaten_id");k.items=V}else{const k=f.value.find(y=>y.id==="kecamatan_id");k.items=V}}})};return(e,l)=>{const p=H,d=G,V=Y,k=O,y=W;return s(),S(U,null,[n(Z,null,{default:r(()=>[n(aa,{class:"pb-4"},{default:r(()=>[n(ea,null,{default:r(()=>l[3]||(l[3]=[T("Tambah PTK")])),_:1,__:[3]})]),_:1}),n(ta),n(j,{ref_key:"refVForm",ref:b,onSubmit:E($,["prevent"])},{default:r(()=>[n(la,null,{default:r(()=>[t(P)?(s(),m(p,{key:0})):(s(),m(v,{key:1},{default:r(()=>[(s(!0),S(U,null,N(t(f),a=>(s(),m(u,{cols:"12"},{default:r(()=>[n(v,{"no-gutters":""},{default:r(()=>[n(u,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>[B("label",{class:"v-label text-body-2 text-high-emphasis",for:a.id},L(a.nama),9,na)]),_:2},1024),n(u,{cols:"12",md:"9"},{default:r(()=>[a.type=="text"?(s(),m(d,{key:0,id:a.id,modelValue:t(i)[a.id],"onUpdate:modelValue":o=>t(i)[a.id]=o,rules:["requiredValidator"in e?e.requiredValidator:t(c)],placeholder:a.nama,"error-messages":t(w)[a.id],"persistent-placeholder":""},null,8,["id","modelValue","onUpdate:modelValue","rules","placeholder","error-messages"])):g("",!0),a.type=="date"?(s(),m(V,{key:1,id:a.id,modelValue:t(i)[a.id],"onUpdate:modelValue":o=>t(i)[a.id]=o,rules:["requiredValidator"in e?e.requiredValidator:t(c)],placeholder:"== Pilih Tanggal ==",config:x},null,8,["id","modelValue","onUpdate:modelValue","rules"])):g("",!0),a.type=="rt_rw"?(s(),m(v,{key:2,"no-gutters":""},{default:r(()=>[n(u,{cols:"6"},{default:r(()=>[n(d,{id:a.id,modelValue:t(i).rt,"onUpdate:modelValue":l[0]||(l[0]=o=>t(i).rt=o),rules:["requiredValidator"in e?e.requiredValidator:t(c)],placeholder:"RT","persistent-placeholder":"",class:"me-1"},null,8,["id","modelValue","rules"])]),_:2},1024),n(u,{cols:"6"},{default:r(()=>[n(d,{id:a.id,modelValue:t(i).rw,"onUpdate:modelValue":l[1]||(l[1]=o=>t(i).rw=o),rules:["requiredValidator"in e?e.requiredValidator:t(c)],placeholder:"RW","persistent-placeholder":"",class:"ms-1"},null,8,["id","modelValue","rules"])]),_:2},1024)]),_:2},1024)):g("",!0),a.type=="select"?(s(),m(k,{key:3,id:a.id,modelValue:t(i)[a.id],"onUpdate:modelValue":o=>t(i)[a.id]=o,rules:["requiredValidator"in e?e.requiredValidator:t(c)],items:a.items,placeholder:`Pilih ${a.nama}`},null,8,["id","modelValue","onUpdate:modelValue","rules","items","placeholder"])):g("",!0),a.type=="wilayah"?(s(),m(y,{key:4,id:a.id,modelValue:t(i)[a.id],"onUpdate:modelValue":[o=>t(i)[a.id]=o,o=>C(a.id,o)],rules:["requiredValidator"in e?e.requiredValidator:t(c)],items:a.items,placeholder:`Pilih ${a.nama}`,"item-title":"nama","item-value":"kode_wilayah"},null,8,["id","modelValue","onUpdate:modelValue","rules","items","placeholder"])):g("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),n(u,{cols:"12"},{default:r(()=>[n(v,{"no-gutters":""},{default:r(()=>[n(u,{cols:"12",md:"3"}),n(u,{cols:"12",md:"9"},{default:r(()=>[n(I,{type:"submit",class:"me-4"},{default:r(()=>l[4]||(l[4]=[T(" Simpan ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1},512)]),_:1}),n(J,{modelValue:t(h),"onUpdate:modelValue":l[2]||(l[2]=a=>D(h)?h.value=a:null),color:"success",location:"top end"},{default:r(()=>l[5]||(l[5]=[T(" PTK baru berhasil disimpan. ")])),_:1,__:[5]},8,["modelValue"])],64)}}};export{xa as default};
