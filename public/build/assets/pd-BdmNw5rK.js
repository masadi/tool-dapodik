import{_ as ia,r as w,V as ra,a as da,i as ua}from"./VForm-BA4d20Jx.js";import{a5 as ma,a6 as _a,at as pa,ad as ka,aQ as fa,aR as ga,aS as ca,ai as ba,aD as va,ae as ya,a9 as ha,b as e,ak as Va,ab as ja,al as Ca,aJ as Pa,am as Da,aT as Sa,aU as xa,ac as Na,aV as Ta,E as wa,r as _,c as p,f as c,l as t,e as l,F as D,k as S,a2 as W,a as Aa,o as r,ay as Ra,s as k,a0 as A,Z as G,d as s,t as u,h as X,$ as qa}from"./main-4hhcoTnx.js";import{_ as Ba}from"./AppAutocomplete-DdPxE-2t.js";import{_ as Ia}from"./AppTextField-CV_Cpl28.js";import{u as $a}from"./useApi-c-D3pQq5.js";import{c as La,V as J}from"./VTable-BdDhpBOz.js";import{$ as E}from"./api-6BZlYoCD.js";import{V as x,a as I,b as $}from"./VCard-C5r7PErk.js";import{V as L}from"./VDivider-rVIt_vZr.js";import{V as F}from"./VCardText-DkC9YI9k.js";import{q as Fa}from"./VDataTable-CtluMcmd.js";import{V as Ka}from"./VAlert-Btp0wKbW.js";import{V as N,a as m}from"./VRow-k-2RrWpH.js";import"./VDialog-CP_oGjGc.js";import"./forwardRefs-BKtaBFVq.js";import"./VImg-BdP77FH8.js";import"./VTextField-BWQb-rx5.js";import"./VList-VacgUzEu.js";import"./VAvatar-B-XCWvkX.js";import"./VMenu-DfT4s1bt.js";import"./VChip-D23iua3i.js";import"./index-CvOPxmL5.js";/* empty css              */const Ua=_a({color:String,...Ta(),...Na(),...xa(),...Sa(),...Da(),...Pa(),...Ca(),...ja(),...Va()},"VSheet"),Ma=ma()({name:"VSheet",props:Ua(),setup(f,K){let{slots:T}=K;const{themeClasses:R}=pa(f),{backgroundColorClasses:U,backgroundColorStyles:b}=ka(()=>f.color),{borderClasses:v}=fa(f),{dimensionStyles:y}=ga(f),{elevationClasses:g}=ca(f),{locationStyles:d}=ba(f),{positionClasses:P}=va(f),{roundedClasses:C}=ya(f);return ha(()=>e(f.tag,{class:["v-sheet",R.value,U.value,v.value,g.value,P.value,C.value,f.class],style:[b.value,y.value,d.value,f.style]},T)),{}}}),za={key:0,class:"ms-3"},Ja={class:"clamp-text text-white mb-0"},Ea=["colspan"],Oa={class:"py-2"},Ha={class:"py-2"},Ya={class:"py-2"},Za={class:"py-2"},Qa={class:"py-2"},Wa={key:1},Ga=["onClick"],Xa={class:"text-center"},ae={class:"text-center"},ee={class:"text-center"},le={key:1},te={key:0},xe={__name:"pd",setup(f){const K={dateFormat:"Y-m-d",locale:ua.Indonesian,altFormat:"j F Y",altInput:!0};wa(async()=>{await U()});const T=_(!1),R=_(),U=async()=>{var n;T.value=!0;try{let h=(await $a(La("/cek-sekolah"))).data.value;R.value=h.sekolah,i.value.sekolah_id=(n=h.sekolah)==null?void 0:n.sekolah_id,i.value.tahun_ajaran_id=h.semester.tahun_ajaran_id,C.value.jenis_pendaftaran=h.jenis_pendaftaran}catch(a){console.error(a)}finally{T.value=!1}},b=_(),v=_(),y=_({jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,rombongan_belajar_id:null}),g=_(!1),d=_(),P=_(!1),C=_({jenis_pendaftaran:[],rombongan_belajar:[]}),aa=async()=>{y.value.nik=void 0,d.value=void 0,i.value.peserta_didik=void 0,P.value=!1,v.value=void 0,b.value?(g.value=!0,await E("/cari-data",{method:"POST",body:{data:"siswa",nik:b.value,sekolah_id:i.value.sekolah_id},async onResponse({response:n}){let a=n._data;P.value=!0,v.value=a.pd,d.value=a.result,Array.isArray(d.value)||(i.value.peserta_didik=d.value),C.value.rombongan_belajar=a.rombongan_belajar,i.value.ptk=d.value,g.value=!1}})):y.value.nik="NIK tidak boleh kosong"},O=n=>{var a={1:"Lulus",2:"Mutasi",3:"Dikeluarkan",4:"Mengundurkan diri",5:"Putus Sekolah",6:"Wafat",7:"Hilang",8:"Alih Fungsi",9:"Pensiun",Z:"Lainnya"};if(n)return a[n]},H=_(),i=_({data:"siswa",sekolah_id:null,nik:null,registrasi_id:null,jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,rombongan_belajar_id:null,peserta_didik:null}),ea=()=>{var n;(n=H.value)==null||n.validate().then(({valid:a})=>{a&&la()})},q=_(!1),B=_({color:"",title:"",text:""}),la=async()=>{g.value=!0,await E("/daftar",{method:"POST",body:i.value,async onResponse({response:n}){let a=n._data;g.value=!1,q.value=!0,B.value=a}})},ta=async()=>{i.value.registrasi_id=null,i.value.jenis_pendaftaran_id=null,i.value.tanggal_masuk_sekolah=null,i.value.nipd=null,i.value.rombongan_belajar_id=null,i.value.peserta_didik=null,b.value=void 0,y.value={jenis_pendaftaran_id:null,tanggal_masuk_sekolah:null,nipd:null,rombongan_belajar_id:null},d.value=[],P.value=!1,C.value.rombongan_belajar=[]},Y=async n=>{console.log(n),await E("/cek-pd",{method:"POST",body:{sekolah_id:i.value.sekolah_id,peserta_didik_id:n,nik:b.value},async onResponse({response:a}){const h=a._data;v.value=h.pd,i.value.peserta_didik=d.value.find(M=>M.peserta_didik_id===n)}})},sa=n=>{console.log(n)};return(n,a)=>{const h=Ia,M=Aa("RouterLink"),Z=Ba,na=da,oa=ia;return r(),p(D,null,[t(T)?(r(),c(x,{key:0,class:"text-center"},{default:l(()=>[e(Ra,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(r(),p(D,{key:1},[t(R)?(r(),c(x,{key:0},{default:l(()=>[e(I,{class:"pb-4"},{default:l(()=>[e($,null,{default:l(()=>a[6]||(a[6]=[k("Tarik PD")])),_:1,__:[6]})]),_:1}),e(L),e(F,null,{default:l(()=>[e(h,{modelValue:t(b),"onUpdate:modelValue":a[0]||(a[0]=o=>W(b)?b.value=o:null),required:"",clearable:"",placeholder:"Masukkan NIK",type:"text",rules:["requiredValidator"in n?n.requiredValidator:t(w)],"error-messages":t(y).nik},{append:l(()=>[e(A,{icon:n.$vuetify.display.smAndDown,onClick:aa,disabled:t(g),loading:t(g)},{default:l(()=>[e(G,{icon:"tabler-search",color:"#fff",size:"22"}),n.$vuetify.display.mdAndUp?(r(),p("span",za,"Cari...")):S("",!0)]),_:1},8,["icon","disabled","loading"])]),_:1},8,["modelValue","rules","error-messages"])]),_:1})]),_:1})):(r(),c(x,{key:1,color:"#007BB6"},{default:l(()=>[e(F,null,{default:l(()=>[s("p",Ja,[a[8]||(a[8]=k(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),e(M,{class:"text-success ms-1",to:{name:"root"}},{default:l(()=>a[7]||(a[7]=[k(" disini ")])),_:1,__:[7]})])]),_:1})]),_:1})),t(P)?(r(),p(D,{key:2},[e(x,{class:"mt-4"},{default:l(()=>[e(I,{class:"pb-4"},{default:l(()=>[e($,null,{default:l(()=>a[9]||(a[9]=[k("Hasil Pencarian")])),_:1,__:[9]})]),_:1}),e(L),t(d)?(r(),p(D,{key:0},[Array.isArray(t(d))?(r(),c(Fa,{key:1,headers:[{title:"Nama",key:"nama"},{title:"NIK",key:"nik"},{title:"NISN",key:"nisn"},{title:"Tempat, Tanggal Lahir",key:"tempat"},{title:"Nama Ibu Kandung",key:"nama_ibu_kandung"},{title:"Detil",key:"data-table-expand",align:"end"}],items:t(d),"item-value":"peserta_didik_id","show-expand":""},{"item.tempat":l(({item:o})=>[k(u(o.tempat_lahir)+", "+u(o.tanggal_lahir),1)]),"item.data-table-expand":l(({internalItem:o,isExpanded:j,toggleExpand:V})=>[e(A,{"append-icon":j(o)?"tabler-chevron-up":"tabler-chevron-down",text:j(o)?"Tutup":"Detil",class:"text-none",color:"medium-emphasis",size:"small",variant:"text",width:"105",border:"",slim:"",onClick:z=>V(o)},null,8,["append-icon","text","onClick"])]),"expanded-row":l(({columns:o,item:j})=>[s("tr",null,[s("td",{colspan:o.length,class:"py-2"},[e(Ma,{rounded:"lg",border:""},{default:l(()=>[e(J,{density:"compact"},{default:l(()=>[a[18]||(a[18]=s("tbody",{class:"bg-surface-light"},[s("tr",null,[s("th",null,"Nama Sekolah"),s("th",null,"NPSN"),s("th",null,"Jenis Keluar"),s("th",null,"Tanggal Keluar"),s("th",null,"Daftarkan")])],-1)),s("tbody",null,[j.registrasi_pd.length?(r(!0),p(D,{key:0},X(j.registrasi_pd,V=>{var z,Q;return r(),p("tr",{key:V.registrasi_id},[s("td",Oa,u((z=V.sekolah)==null?void 0:z.nama),1),s("td",Ha,u((Q=V.sekolah)==null?void 0:Q.npsn),1),s("td",Ya,u(O(V.jenis_keluar_id)),1),s("td",Za,u(V.tanggal_keluar),1),s("td",Qa,[e(A,{size:"small",onClick:se=>Y(j.peserta_didik_id)},{default:l(()=>a[15]||(a[15]=[k("Daftarkan")])),_:2,__:[15]},1032,["onClick"])])])}),128)):(r(),p("tr",Wa,[a[17]||(a[17]=s("td",{class:"py-2 text-center",colspan:"4"}," Tidak data untuk ditampilan ",-1)),s("td",null,[e(A,{size:"small",onClick:V=>Y(j.peserta_didik_id)},{default:l(()=>a[16]||(a[16]=[k("Daftarkan")])),_:2,__:[16]},1032,["onClick"])])]))])]),_:2,__:[18]},1024)]),_:2},1024)],8,Ea)])]),_:1},8,["items"])):(r(),c(J,{key:0},{default:l(()=>[s("tbody",null,[s("tr",null,[a[10]||(a[10]=s("td",null,"Nama",-1)),s("td",null,u(t(d).nama),1)]),s("tr",null,[a[11]||(a[11]=s("td",null,"NIK",-1)),s("td",null,u(t(d).nik),1)]),s("tr",null,[a[12]||(a[12]=s("td",null,"NISN",-1)),s("td",null,u(t(d).nisn),1)]),s("tr",null,[a[13]||(a[13]=s("td",null,"Tempat, Tanggal Lahir",-1)),s("td",null,u(t(d).tempat_lahir)+", "+u(t(d).tanggal_lahir),1)]),s("tr",null,[a[14]||(a[14]=s("td",null,"Nama Ibu Kandung",-1)),s("td",null,u(t(d).nama_ibu_kandung),1)])])]),_:1}))],64)):(r(),c(F,{key:1},{default:l(()=>a[19]||(a[19]=[k(" NIK tidak ditemukan! ")])),_:1,__:[19]}))]),_:1}),t(d)&&!Array.isArray(t(d))?(r(),c(x,{key:0,class:"mt-4"},{default:l(()=>[e(I,{class:"pb-4"},{default:l(()=>[e($,null,{default:l(()=>a[20]||(a[20]=[k("Riwayat Pendidikan Siswa")])),_:1,__:[20]})]),_:1}),e(L),e(J,null,{default:l(()=>[a[22]||(a[22]=s("thead",null,[s("tr",null,[s("th",null,"Nama Sekolah"),s("th",{class:"text-center"},"NPSN"),s("th",{class:"text-center"},"Jenis Keluar"),s("th",{class:"text-center"},"Tanggal Keluar")])],-1)),s("tbody",null,[t(d).registrasi_pd.length?(r(!0),p(D,{key:0},X(t(d).registrasi_pd,(o,j)=>(r(),p("tr",{key:o.registrasi_id},[s("td",null,[k(u(o.sekolah.nama)+" ",1),o.sekolah_id.toLowerCase()===t(i).sekolah_id?(r(),p("a",{key:0,href:"javascript:void(0)",onClick:V=>sa(o.registrasi_id)},[e(G,{icon:"tabler-clipboard-check"})],8,Ga)):S("",!0)]),s("td",Xa,u(o.sekolah.npsn),1),s("td",ae,u(O(o.jenis_keluar_id)),1),s("td",ee,u(o.tanggal_keluar),1)]))),128)):(r(),p("tr",le,a[21]||(a[21]=[s("td",{colspan:"4",class:"py-4 text-center"}," Tidak ada data untuk ditampilkan ",-1)])))])]),_:1,__:[22]})]),_:1})):S("",!0),t(i).peserta_didik?(r(),c(x,{key:1,class:"mt-4"},{default:l(()=>[e(I,{class:"pb-4"},{default:l(()=>[e($,null,{default:l(()=>a[23]||(a[23]=[k("Daftarkan Peserta Didik")])),_:1,__:[23]})]),_:1}),e(L),e(F,null,{default:l(()=>[t(v)?(r(),c(Ka,{key:0,color:"error"},{default:l(()=>[k(" Peserta Didik atas nama "+u(t(v).nama)+" telah terdaftar ",1),t(v).kelas?(r(),p("span",te,"di Rombongan Belajar "+u(t(v).kelas.nama),1)):S("",!0)]),_:1})):(r(),c(ra,{key:1,ref_key:"refVForm",ref:H,onSubmit:qa(ea,["prevent"])},{default:l(()=>[e(N,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[24]||(a[24]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"jenis_pendaftaran_id"},"Jenis Pendaftaran ",-1)])),_:1,__:[24]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(Z,{id:"jenis_ptk_id",modelValue:t(i).jenis_pendaftaran_id,"onUpdate:modelValue":a[1]||(a[1]=o=>t(i).jenis_pendaftaran_id=o),items:t(C).jenis_pendaftaran,placeholder:"== Pilih Jenis Pendaftaran ==","item-title":"nama","item-value":"jenis_pendaftaran_id",rules:["requiredValidator"in n?n.requiredValidator:t(w)],"error-messages":t(y).jenis_pendaftaran_id},null,8,["modelValue","items","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[25]||(a[25]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"tanggal_masuk_sekolah"},"Tanggal Masuk Sekolah ",-1)])),_:1,__:[25]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(na,{id:"tanggal_masuk_sekolah",modelValue:t(i).tanggal_masuk_sekolah,"onUpdate:modelValue":a[2]||(a[2]=o=>t(i).tanggal_masuk_sekolah=o),rules:["requiredValidator"in n?n.requiredValidator:t(w)],placeholder:"== Pilih Tanggal ==",config:K},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[26]||(a[26]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"nipd"},"Nomor Induk Siswa",-1)])),_:1,__:[26]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(h,{id:"nipd",modelValue:t(i).nipd,"onUpdate:modelValue":a[3]||(a[3]=o=>t(i).nipd=o),placeholder:"Nomor Induk Siswa","persistent-placeholder":"",rules:["requiredValidator"in n?n.requiredValidator:t(w)],"error-messages":t(y).nipd},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:l(()=>a[27]||(a[27]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1,__:[27]}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(Z,{id:"rombongan_belajar_id",modelValue:t(i).rombongan_belajar_id,"onUpdate:modelValue":a[4]||(a[4]=o=>t(i).rombongan_belajar_id=o),items:t(C).rombongan_belajar,placeholder:"== Pilih Rombongan Belajar ==","item-title":"nama","item-value":"rombongan_belajar_id",rules:["requiredValidator"in n?n.requiredValidator:t(w)],"error-messages":t(y).rombongan_belajar_id},null,8,["modelValue","items","rules","error-messages"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(m,{cols:"12",md:"3"}),e(m,{cols:"12",md:"9"},{default:l(()=>[e(A,{type:"submit",class:"me-4",disabled:t(g),loading:t(g)},{default:l(()=>a[28]||(a[28]=[k(" Simpan ")])),_:1,__:[28]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512))]),_:1})]),_:1})):S("",!0)],64)):S("",!0)],64)),e(oa,{isDialogVisible:t(q),"onUpdate:isDialogVisible":a[5]||(a[5]=o=>W(q)?q.value=o:null),"confirm-color":t(B).color,"confirm-title":t(B).title,"confirm-msg":t(B).text,onConfirm:ta},null,8,["isDialogVisible","confirm-color","confirm-title","confirm-msg"])],64)}}};export{xe as default};
