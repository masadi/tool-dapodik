import{a as H,f as k,o as d,e,b as t,Z as w,r as f,E as M,c as $,l,F as O,s as n,d as i,a0 as y,au as j,t as b,k as A,a2 as R}from"./main-BUXKE4KP.js";import{_ as G}from"./AppAutocomplete-B8fu6InC.js";import{$ as I}from"./api-DuF8TV_x.js";import{u as P,b as J,a as K}from"./useApi-STwI3K2t.js";import{c as S,V as L}from"./VTable-BUyyDPBb.js";import{V as D,a as B,b as x}from"./VCard-xA-Paepu.js";import{V as _}from"./VCardText-KMEZFsKA.js";import{V as Z}from"./VAlert-BnTRhHuN.js";import{V as Q}from"./VDialog-DK2MLD9K.js";import"./VTextField-Coj_8iKj.js";import"./VImg-CFLmFRth.js";import"./forwardRefs-D-YeBg7N.js";import"./VList-DXo_LOTW.js";import"./VAvatar-Cy_AKwgz.js";import"./VDivider-D_O1MR7c.js";import"./VMenu-BMpTovAW.js";import"./VChip-C0mkN0by.js";import"./index-CvOPxmL5.js";const W={__name:"DialogCloseBtn",props:{icon:{type:String,required:!1,default:"tabler-x"},iconSize:{type:String,required:!1,default:"20"}},setup(N){const u=N;return(r,c)=>{const g=H("IconBtn");return d(),k(g,{variant:"elevated",size:"30",ripple:!1,class:"v-dialog-close-btn"},{default:e(()=>[t(w,{icon:u.icon,size:u.iconSize},null,8,["icon","size"])]),_:1})}}},X={key:0,class:"ms-3"},ga={__name:"index",setup(N){const u=f(),r=f(),c=f([]),g=f(!0),T=f(!1),U=async()=>{var a;const o=c.value.find(s=>s.sekolah_id===u.value);await I("/sekolah",{method:"POST",body:{sekolah_id:u.value,pengguna_id:(a=o==null?void 0:o.pengguna)==null?void 0:a.pengguna_id},async onResponse({response:s}){let C=s._data;g.value=C.allowed,await V()}})};M(async()=>{await V()});const v=f(!1),V=async()=>{var o;v.value=!0;try{let s=(await P(S("/sekolah"))).data.value;c.value=s.sekolah,r.value=(o=s.user)==null?void 0:o.sekolah,T.value=s.error}catch(a){console.error(a)}finally{v.value=!1}},p=f(!1),Y=()=>{p.value=!0},q=async()=>{p.value=!1,await P(S("/reset")),K()},E=async()=>{console.log("connectToDapo"),await J(S("normalkan")),await V()},F=async o=>{console.log(o),await I("/sekolah",{method:"POST",body:{data:"yayasan",yayasan_id:o},async onResponse({response:a}){let s=a._data;console.log(s),await V()}})};return(o,a)=>{const s=G,C=W;return d(),$(O,null,[t(D,{color:"#007BB6"},{default:e(()=>[t(B,null,{prepend:e(()=>[t(w,{size:"1.9rem",color:"white",icon:"tabler-database"})]),default:e(()=>[t(x,{class:"text-white"},{default:e(()=>a[5]||(a[5]=[n(" Tool Dapodik ")])),_:1,__:[5]})]),_:1}),t(_,null,{default:e(()=>a[6]||(a[6]=[i("p",{class:"clamp-text text-white mb-0"},"Harap Gunakan dengan BIJAK!",-1)])),_:1,__:[6]})]),_:1}),l(T)?(d(),k(D,{key:0,class:"mt-4"},{default:e(()=>[t(x,null,{default:e(()=>a[7]||(a[7]=[n(" Aplikasi tidak terhubung ke Database Dapodik! ")])),_:1,__:[7]}),t(B,null,{default:e(()=>[t(y,{block:"",size:"large",onClick:E},{default:e(()=>a[8]||(a[8]=[n("Hubungkan Aplikasi ke Database Dapodik")])),_:1,__:[8]})]),_:1})]),_:1})):(d(),k(D,{key:1,class:"mt-4"},{default:e(()=>[t(B,null,j({default:e(()=>[t(x,null,{default:e(()=>[n(b(l(r)?"Data":"Registrasi")+" Sekolah ",1)]),_:1})]),_:2},[l(r)?{name:"append",fn:e(()=>[t(y,{color:"error",onClick:Y},{default:e(()=>a[9]||(a[9]=[n("Reset")])),_:1,__:[9]})]),key:"0"}:void 0]),1024),l(r)?(d(),k(_,{key:0},{default:e(()=>[l(g)?A("",!0):(d(),k(Z,{key:0,color:"error"},{default:e(()=>a[10]||(a[10]=[n(" NPSN tidak terdaftar! ")])),_:1,__:[10]})),t(L,null,{default:e(()=>{var m,z;return[i("tbody",null,[i("tr",null,[a[11]||(a[11]=i("td",null,"Nama",-1)),i("td",null,b(l(r).nama),1)]),i("tr",null,[a[12]||(a[12]=i("td",null,"NPSN",-1)),i("td",null,b(l(r).npsn),1)]),i("tr",null,[a[14]||(a[14]=i("td",null,"Yayasan",-1)),i("td",null,[n(b((m=l(r).yayasan)==null?void 0:m.nama)+" ",1),((z=l(r).yayasan)==null?void 0:z.soft_delete)=="1"?(d(),k(y,{key:0,color:"error",size:"small",class:"ms-4",onClick:a[0]||(a[0]=h=>F(l(r).yayasan.yayasan_id))},{default:e(()=>[t(w,{start:"",icon:"tabler-restore"}),a[13]||(a[13]=n(" Restore Yayasan "))]),_:1,__:[13]})):A("",!0)])])])]}),_:1})]),_:1})):(d(),k(_,{key:1},{default:e(()=>[t(s,{modelValue:l(u),"onUpdate:modelValue":a[1]||(a[1]=m=>R(u)?u.value=m:null),items:l(c),"item-title":"nama","item-value":"sekolah_id",placeholder:"Pilih Sekolah",disabled:l(v),loading:l(v)},{append:e(()=>[t(y,{icon:o.$vuetify.display.smAndDown,onClick:U},{default:e(()=>[t(w,{icon:"tabler-device-floppy",color:"#fff",size:"22"}),o.$vuetify.display.mdAndUp?(d(),$("span",X,"Simpan")):A("",!0)]),_:1},8,["icon"])]),_:1},8,["modelValue","items","disabled","loading"])]),_:1})),t(Q,{modelValue:l(p),"onUpdate:modelValue":a[4]||(a[4]=m=>R(p)?p.value=m:null),persistent:"",class:"v-dialog-sm"},{default:e(()=>[t(C,{onClick:a[2]||(a[2]=m=>p.value=!l(p))}),t(D,{title:"Apakah Anda yakin?"},{default:e(()=>[t(_,null,{default:e(()=>a[15]||(a[15]=[n(" Tindakan ini akan mengambalikan Aplikasi ke awal! ")])),_:1,__:[15]}),t(_,{class:"d-flex justify-end gap-3 flex-wrap"},{default:e(()=>[t(y,{color:"secondary",variant:"tonal",onClick:a[3]||(a[3]=m=>p.value=!1)},{default:e(()=>a[16]||(a[16]=[n(" Batal ")])),_:1,__:[16]}),t(y,{onClick:q},{default:e(()=>a[17]||(a[17]=[n(" Yakin ")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))],64)}}};export{ga as default};
