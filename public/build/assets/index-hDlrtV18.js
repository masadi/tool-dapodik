import{a as L,f as u,o as i,e,b as t,Z as w,r as k,E as M,c as I,l,F as O,s as n,d as o,a0 as y,au as W,t as V,k as S,a2 as P}from"./main-BBeR6XVV.js";import{_ as G}from"./AppAutocomplete-WW741ojG.js";import{$ as R}from"./api-dBY3XVoR.js";import{u as U,b as J,a as K}from"./useApi-CPOtDUZ3.js";import{c as A,V as Z}from"./VTable-DgoB2Tvy.js";import{V as D,a as B,b as x}from"./VCard-CR52vXdf.js";import{V as _}from"./VCardText-C64EnDVd.js";import{V as j}from"./VAlert-B6DZWnSO.js";import{V as Q}from"./VDialog-CEggmTKD.js";import"./VTextField-BphGpWbK.js";import"./VImg-Dluj_JUu.js";import"./forwardRefs-A04Mi118.js";import"./VList-Cax3Dcs5.js";import"./VAvatar-uTJpscJT.js";import"./VDivider-BMJX0LFQ.js";import"./VMenu-DS0P4sCM.js";import"./VChip-DjWddHzB.js";import"./index-CvOPxmL5.js";const X={__name:"DialogCloseBtn",props:{icon:{type:String,required:!1,default:"tabler-x"},iconSize:{type:String,required:!1,default:"20"}},setup(T){const p=T;return(d,c)=>{const g=L("IconBtn");return i(),u(g,{variant:"elevated",size:"30",ripple:!1,class:"v-dialog-close-btn"},{default:e(()=>[t(w,{icon:p.icon,size:p.iconSize},null,8,["icon","size"])]),_:1})}}},h={key:0,class:"ms-3"},va={__name:"index",setup(T){const p=k(),d=k(),c=k([]),g=k(!0),N=k(!0),z=k(!1),Y=async()=>{var a;const s=c.value.find(r=>r.sekolah_id===p.value);await R("/sekolah",{method:"POST",body:{sekolah_id:p.value,pengguna_id:(a=s==null?void 0:s.pengguna)==null?void 0:a.pengguna_id},async onResponse({response:r}){let C=r._data;g.value=C.allowed,await b()}})};M(async()=>{await b()});const v=k(!1),b=async()=>{var s;v.value=!0;try{let r=(await U(A("/sekolah"))).data.value;c.value=r.sekolah,d.value=(s=r.user)==null?void 0:s.sekolah,z.value=r.error,N.value=r.jam_sinkron}catch(a){console.error(a)}finally{v.value=!1}},m=k(!1),q=()=>{m.value=!0},E=async()=>{m.value=!1,await U(A("/reset")),K()},F=async()=>{console.log("connectToDapo"),await J(A("normalkan")),await b()},H=async s=>{console.log(s),await R("/sekolah",{method:"POST",body:{data:"yayasan",yayasan_id:s},async onResponse({response:a}){let r=a._data;console.log(r),await b()}})};return(s,a)=>{const r=G,C=X;return i(),I(O,null,[t(D,{color:"#007BB6"},{default:e(()=>[t(B,null,{prepend:e(()=>[t(w,{size:"1.9rem",color:"white",icon:"tabler-database"})]),default:e(()=>[t(x,{class:"text-white"},{default:e(()=>a[5]||(a[5]=[n(" Tool Dapodik ")])),_:1,__:[5]})]),_:1}),t(_,null,{default:e(()=>a[6]||(a[6]=[o("p",{class:"clamp-text text-white mb-0"},"Harap Gunakan dengan BIJAK!",-1)])),_:1,__:[6]})]),_:1}),l(z)?(i(),u(D,{key:0,class:"mt-4"},{default:e(()=>[t(x,null,{default:e(()=>a[7]||(a[7]=[n(" Aplikasi tidak terhubung ke Database Dapodik! ")])),_:1,__:[7]}),t(B,null,{default:e(()=>[t(y,{block:"",size:"large",onClick:F},{default:e(()=>a[8]||(a[8]=[n("Hubungkan Aplikasi ke Database Dapodik")])),_:1,__:[8]})]),_:1})]),_:1})):(i(),u(D,{key:1,class:"mt-4"},{default:e(()=>[t(B,null,W({default:e(()=>[t(x,null,{default:e(()=>[n(V(l(d)?"Data":"Registrasi")+" Sekolah ",1)]),_:1})]),_:2},[l(d)?{name:"append",fn:e(()=>[t(y,{color:"error",onClick:q},{default:e(()=>a[9]||(a[9]=[n("Reset")])),_:1,__:[9]})]),key:"0"}:void 0]),1024),l(d)?(i(),u(_,{key:0},{default:e(()=>[l(g)?S("",!0):(i(),u(j,{key:0,color:"error"},{default:e(()=>a[10]||(a[10]=[n(" NPSN tidak terdaftar! ")])),_:1,__:[10]})),t(Z,null,{default:e(()=>{var f,$;return[o("tbody",null,[o("tr",null,[a[11]||(a[11]=o("td",null,"Nama",-1)),o("td",null,V(l(d).nama),1)]),o("tr",null,[a[12]||(a[12]=o("td",null,"NPSN",-1)),o("td",null,V(l(d).npsn),1)]),o("tr",null,[a[14]||(a[14]=o("td",null,"Yayasan",-1)),o("td",null,[n(V((f=l(d).yayasan)==null?void 0:f.nama)+" ",1),(($=l(d).yayasan)==null?void 0:$.soft_delete)=="1"?(i(),u(y,{key:0,color:"error",size:"small",class:"ms-4",onClick:a[0]||(a[0]=aa=>H(l(d).yayasan.yayasan_id))},{default:e(()=>[t(w,{start:"",icon:"tabler-restore"}),a[13]||(a[13]=n(" Restore Yayasan "))]),_:1,__:[13]})):S("",!0)])])])]}),_:1})]),_:1})):(i(),u(_,{key:1},{default:e(()=>[l(N)?(i(),u(r,{key:0,modelValue:l(p),"onUpdate:modelValue":a[1]||(a[1]=f=>P(p)?p.value=f:null),items:l(c),"item-title":"nama","item-value":"sekolah_id",placeholder:"Pilih Sekolah",disabled:l(v),loading:l(v)},{append:e(()=>[t(y,{icon:s.$vuetify.display.smAndDown,onClick:Y},{default:e(()=>[t(w,{icon:"tabler-device-floppy",color:"#fff",size:"22"}),s.$vuetify.display.mdAndUp?(i(),I("span",h,"Simpan")):S("",!0)]),_:1},8,["icon"])]),_:1},8,["modelValue","items","disabled","loading"])):(i(),u(j,{key:1,color:"error",class:"text-center",variant:"tonal"},{default:e(()=>a[15]||(a[15]=[o("h2",{class:"mt-4 mb-4"},"Penyesuaian Waktu Layanan Tarik Data Dapodik",-1),o("p",null,[n(" Dikarenakan adanya proses rutin sinkronisasi data Dapodik di Server PUSDATIN, "),o("br"),n("maka layanan sinkronisasi hanya dapat diakses antara pukul "),o("span",{class:"text-danger"},[o("b",null,"03.00 s/d 24.00 (WIB)")])],-1)])),_:1,__:[15]}))]),_:1})),t(Q,{modelValue:l(m),"onUpdate:modelValue":a[4]||(a[4]=f=>P(m)?m.value=f:null),persistent:"",class:"v-dialog-sm"},{default:e(()=>[t(C,{onClick:a[2]||(a[2]=f=>m.value=!l(m))}),t(D,{title:"Apakah Anda yakin?"},{default:e(()=>[t(_,null,{default:e(()=>a[16]||(a[16]=[n(" Tindakan ini akan mengambalikan Aplikasi ke awal! ")])),_:1,__:[16]}),t(_,{class:"d-flex justify-end gap-3 flex-wrap"},{default:e(()=>[t(y,{color:"secondary",variant:"tonal",onClick:a[3]||(a[3]=f=>m.value=!1)},{default:e(()=>a[17]||(a[17]=[n(" Batal ")])),_:1,__:[17]}),t(y,{onClick:E},{default:e(()=>a[18]||(a[18]=[n(" Yakin ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))],64)}}};export{va as default};
