import{_ as A}from"./AppTextField-BTuesZNV.js";import{V as E,_ as F,a as I}from"./VSnackbar-DQhK1QHL.js";import{u as B}from"./useApi-CvZadkO7.js";import{c as C}from"./VTable-BMSQVn9i.js";import{$ as J}from"./api-DrdBXFi7.js";import{V as j,a as M,b as q}from"./VCard-D2hcd3D4.js";import{E as O,r as _,w as D,f as x,c as W,l as t,e as i,b as o,a2 as G,F as H,a as X,o as c,ay as Y,s as m,d as p,a0 as Z,t as ee,az as ae}from"./main-Iqtz8i1F.js";import{V as T}from"./VDivider-BdbCyKOn.js";import{V as z}from"./VCardText-BAtbGeDV.js";import{V as te}from"./VSpacer-BMAjlw5g.js";import{V as le,a as K}from"./VRow-5Gl5XvZq.js";import"./VTextField-CI7IcPVX.js";import"./VImg-Cszk4qGl.js";import"./forwardRefs-Ctr6MP8Q.js";import"./VDataTable-C-7oZC6k.js";import"./VChip-B0HHxjZg.js";import"./VAvatar-BgPNHADy.js";import"./VList-tTLtVv8h.js";import"./VMenu-vZL1ir3b.js";import"./index-CvOPxmL5.js";/* empty css              */const se={class:"d-flex gap-2 align-center"},re={class:"d-flex align-center flex-wrap gap-4"},oe={class:"clamp-text text-white mb-0"},Be={__name:"pd",setup(ie){O(async()=>{await N()});const f=_(!1),v=_(),N=async()=>{var r;f.value=!0;try{let a=(await B(C("/cek-sekolah"))).data.value;v.value=a.sekolah,s.value.semester_id=(r=a.semester)==null?void 0:r.semester_id,v.value&&S()}catch(l){console.error(l)}finally{f.value=!1}},R=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"NISN",key:"nisn",align:"center"},{title:"Kelas",key:"kelas",align:"center",sortable:!1},{title:"Tinggi Badan",key:"tinggi",sortable:!1},{title:"Berat Badan",key:"berat",align:"center",sortable:!1},{title:"Jarak",key:"jarak",align:"center",sortable:!1},{title:"waktu",key:"waktu",align:"center",sortable:!1},{title:"Jml Saudara Kandung",key:"saudara",align:"center",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],n=_({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"nama",sortbydesc:"ASC"}),V=_(!1),y=_([]),w=_(0),L=r=>{var l,a;n.value.sortby=(l=r[0])==null?void 0:l.key,n.value.sortbydesc=(a=r[0])==null?void 0:a.order},s=_({semester_id:null,tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),g=_(!1),S=async()=>{V.value=!0;try{let l=(await B(C("/periodik",{query:{q:n.value.searchQuery,page:n.value.page,per_page:n.value.itemsPerPage,sortby:n.value.sortby,sortbydesc:n.value.sortbydesc}}))).data.value;y.value=l.data.data,w.value=l.data.total,y.value.forEach(a=>{s.value.tinggi_badan[a.peserta_didik_id]=a.periodik?a.periodik.tinggi_badan:null,s.value.berat_badan[a.peserta_didik_id]=a.periodik?a.periodik.berat_badan:null,s.value.jarak_rumah_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.jarak_rumah_ke_sekolah:null,s.value.waktu_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.waktu_tempuh_ke_sekolah:null,s.value.menit_tempuh_ke_sekolah[a.peserta_didik_id]=a.periodik?a.periodik.menit_tempuh_ke_sekolah:null,s.value.jumlah_saudara_kandung[a.peserta_didik_id]=a.periodik?a.periodik.jumlah_saudara_kandung:null})}catch(r){console.error(r)}finally{V.value=!1}};D(n,ae(()=>{S()},500),{deep:!0}),D(()=>n.value.searchQuery,()=>{n.value.page=1});const h=_([]),Q=_(),u=_({tinggi_badan:{},berat_badan:{},jarak_rumah_ke_sekolah:{},waktu_tempuh_ke_sekolah:{},menit_tempuh_ke_sekolah:{},jumlah_saudara_kandung:{}}),$=async r=>{Q.value=r,h.value[r]=!0,await J("/periodik",{method:"POST",body:{semester_id:s.value.semester_id,peserta_didik_id:r,tinggi_badan:s.value.tinggi_badan[r],berat_badan:s.value.berat_badan[r],jarak_rumah_ke_sekolah:s.value.jarak_rumah_ke_sekolah[r],waktu_tempuh_ke_sekolah:s.value.waktu_tempuh_ke_sekolah[r],menit_tempuh_ke_sekolah:s.value.menit_tempuh_ke_sekolah[r],jumlah_saudara_kandung:s.value.jumlah_saudara_kandung[r]},async onResponse({response:l}){var k,b,e,d,U,P;console.log(s.value.tinggi_badan[r]);const a=l._data;h.value[r]=!1,u.value.tinggi_badan[r]=((k=a.errors)==null?void 0:k.tinggi_badan)??void 0,u.value.berat_badan[r]=((b=a.errors)==null?void 0:b.berat_badan)??void 0,u.value.jarak_rumah_ke_sekolah[r]=((e=a.errors)==null?void 0:e.jarak_rumah_ke_sekolah)??void 0,u.value.waktu_tempuh_ke_sekolah[r]=((d=a.errors)==null?void 0:d.waktu_tempuh_ke_sekolah)??void 0,u.value.menit_tempuh_ke_sekolah[r]=((U=a.errors)==null?void 0:U.menit_tempuh_ke_sekolah)??void 0,u.value.jumlah_saudara_kandung[r]=((P=a.errors)==null?void 0:P.jumlah_saudara_kandung)??void 0,a.errors||(g.value=!0)}})};return(r,l)=>{const a=F,k=A,b=X("RouterLink");return t(f)?(c(),x(j,{key:0,class:"text-center"},{default:i(()=>[o(Y,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(c(),W(H,{key:1},[t(v)?(c(),x(j,{key:0},{default:i(()=>[o(M,{class:"pb-4"},{default:i(()=>[o(q,null,{default:i(()=>l[4]||(l[4]=[m("Data Periodik Siswa")])),_:1,__:[4]})]),_:1}),o(T),o(z,{class:"d-flex flex-wrap gap-4"},{default:i(()=>[p("div",se,[o(a,{modelValue:t(n).itemsPerPage,"onUpdate:modelValue":l[0]||(l[0]=e=>t(n).itemsPerPage=e),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),o(te),p("div",re,[o(k,{modelValue:t(n).searchQuery,"onUpdate:modelValue":l[1]||(l[1]=e=>t(n).searchQuery=e),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),o(T),o(I,{page:t(n).page,"onUpdate:page":l[2]||(l[2]=e=>t(n).page=e),"items-per-page":t(n).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:t(y),"server-items-length":t(w),"items-length":t(w),headers:R,"items-per-page-text":"Item",options:t(n),loading:t(V),"loading-text":"Loading...","onUpdate:sortBy":L,"header-props":{class:"text-no-wrap"}},{"header.waktu":i(({item:e})=>l[5]||(l[5]=[m(" Waktu Tempuh "),p("br",null,null,-1),m(" Jam | Menit ")])),"header.saudara":i(({item:e})=>l[6]||(l[6]=[m(" Jml Saudara "),p("br",null,null,-1),m(" Kandung ")])),"item.kelas":i(({item:e})=>{var d;return[m(ee((d=e.kelas)==null?void 0:d.nama),1)]}),"item.tinggi":i(({item:e})=>[o(k,{modelValue:t(s).tinggi_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).tinggi_badan[e.peserta_didik_id]=d,"error-messages":t(u).tinggi_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.berat":i(({item:e})=>[o(k,{modelValue:t(s).berat_badan[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).berat_badan[e.peserta_didik_id]=d,"error-messages":t(u).berat_badan[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.jarak":i(({item:e})=>[o(a,{items:[{title:"Kurang dari 1 KM",value:"1"},{title:"Lebih dari 1 KM",value:"2"}],modelValue:t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).jarak_rumah_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).jarak_rumah_ke_sekolah[e.peserta_didik_id],style:{"inline-size":"10rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.waktu":i(({item:e})=>[o(le,null,{default:i(()=>[o(K,{cols:"12",sm:"6"},{default:i(()=>[o(k,{modelValue:t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).waktu_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).waktu_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024),o(K,{cols:"12",sm:"6"},{default:i(()=>[o(k,{modelValue:t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).menit_tempuh_ke_sekolah[e.peserta_didik_id]=d,"error-messages":t(u).menit_tempuh_ke_sekolah[e.peserta_didik_id]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),_:2},1024)]),_:2},1024)]),"item.saudara":i(({item:e})=>[o(k,{modelValue:t(s).jumlah_saudara_kandung[e.peserta_didik_id],"onUpdate:modelValue":d=>t(s).jumlah_saudara_kandung[e.peserta_didik_id]=d,"error-messages":t(u).jumlah_saudara_kandung[e.peserta_didik_id],style:{"inline-size":"5rem"}},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),"item.aksi":i(({item:e})=>[o(Z,{size:"small",onClick:d=>$(e.peserta_didik_id),disabled:t(h)[e.peserta_didik_id],loading:t(h)[e.peserta_didik_id]},{default:i(()=>l[7]||(l[7]=[m("Simpan")])),_:2,__:[7]},1032,["onClick","disabled","loading"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"])]),_:1})):(c(),x(j,{key:1,color:"#007BB6"},{default:i(()=>[o(z,null,{default:i(()=>[p("p",oe,[l[9]||(l[9]=m(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),o(b,{class:"text-success ms-1",to:{name:"root"}},{default:i(()=>l[8]||(l[8]=[m(" disini ")])),_:1,__:[8]})])]),_:1})]),_:1})),o(E,{modelValue:t(g),"onUpdate:modelValue":l[3]||(l[3]=e=>G(g)?g.value=e:null),color:"success",location:"top end"},{default:i(()=>l[10]||(l[10]=[m(" Data Periodik berhasil disimpan. ")])),_:1,__:[10]},8,["modelValue"])],64))}}};export{Be as default};
