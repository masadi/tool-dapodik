import{_ as Q}from"./AppAutocomplete-NzqZNerQ.js";import{_ as E}from"./AppTextField-Ciy4apEb.js";import{V as F,_ as q,a as O}from"./VSnackbar-I4YH2O3K.js";import{u as U}from"./useApi-BWjN2qok.js";import{c as C}from"./VTable-NlKXlxV7.js";import{$ as D}from"./api-BWdT9Mw5.js";import{V as h,a as M,b as Y}from"./VCard-0saSSTiW.js";import{E as G,r as d,w as B,f as P,c as H,l as a,e as i,b as r,a2 as W,F as X,a as Z,o as c,ay as ee,s as u,d as x,a0 as ae,az as te}from"./main-Dzs_CAgs.js";import{V as I}from"./VDivider-DvomKPbr.js";import{V as K}from"./VCardText-C94KSfEt.js";import{V as le}from"./VSpacer-DLVuscge.js";import"./VTextField-DDvuboFK.js";import"./VImg-Bz1ivnlY.js";import"./forwardRefs-BZjvUaET.js";import"./VList-uaFLNDuS.js";import"./VAvatar-D763mIUj.js";import"./VMenu-CxQ93pQk.js";import"./VChip-HbpO5J_9.js";import"./VDataTable-DN2zIp5n.js";import"./index-CvOPxmL5.js";/* empty css              */const se={class:"d-flex gap-2 align-center"},re={class:"d-flex align-center flex-wrap gap-4"},oe={class:"clamp-text text-white mb-0"},Ue={__name:"ptk",setup(ie){G(async()=>{await A()});const v=d(!1),g=d(),A=async()=>{v.value=!0;try{let e=(await U(C("/cek-sekolah"))).data.value;g.value=e.sekolah,g.value&&S()}catch(l){console.error(l)}finally{v.value=!1}},R=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"NIK",key:"nik"},{title:"Induk",key:"induk",align:"center",sortable:!1},{title:"Jenis PTK",key:"jenis_ptk",sortable:!1},{title:"Jabatan PTK",key:"jabatan_ptk",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],s=d({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"nama",sortbydesc:"ASC"}),b=d(!1),y=d([]),V=d(0),T=d([]),j=d([]),$=l=>{var e,o;s.value.sortby=(e=l[0])==null?void 0:e.key,s.value.sortbydesc=(o=l[0])==null?void 0:o.order},n=d({ptk_induk:{},jenis_ptk_id:{},jabatan_ptk_id:{}}),_=d(!1),S=async()=>{b.value=!0;try{let e=(await U(C("/guru",{query:{q:s.value.searchQuery,page:s.value.page,per_page:s.value.itemsPerPage,sortby:s.value.sortby,sortbydesc:s.value.sortbydesc}}))).data.value;y.value=e.data.data,V.value=e.data.total,T.value=e.jenis_ptk,y.value.forEach(o=>{j.value[o.ptk_terdaftar.ptk_terdaftar_id]=e.jabatan,n.value.ptk_induk[o.ptk_terdaftar.ptk_terdaftar_id]=parseInt(o.ptk_terdaftar.ptk_induk),n.value.jenis_ptk_id[o.ptk_terdaftar.ptk_terdaftar_id]=parseInt(o.ptk_terdaftar.jenis_ptk_id),n.value.jabatan_ptk_id[o.ptk_terdaftar.ptk_terdaftar_id]=parseInt(o.ptk_terdaftar.jabatan_ptk_id)})}catch(l){console.error(l)}finally{b.value=!1}};B(s,te(()=>{S()},500),{deep:!0}),B(()=>s.value.searchQuery,()=>{s.value.page=1});const m=d([]),z=d(),J=async l=>{z.value=l,m.value[l]=!0,await D("/guru",{method:"POST",body:{ptk_terdaftar_id:l,ptk_induk:n.value.ptk_induk[l],jenis_ptk_id:n.value.jenis_ptk_id[l],jabatan_ptk_id:n.value.jabatan_ptk_id[l]},async onResponse(){m.value[l]=!1,_.value=!0}})},k=d([]),L=async(l,e)=>{console.log(e),k.value[l]=!0,await D("/get-jabatan",{method:"POST",body:{jenis_ptk_id:e},async onResponse({response:o}){let f=o._data;k.value[l]=!1,n.value.jabatan_ptk_id[l]=null,console.log(f),j.value[l]=f}})};return(l,e)=>{const o=q,f=E,w=Q,N=Z("RouterLink");return a(v)?(c(),P(h,{key:0,class:"text-center"},{default:i(()=>[r(ee,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(c(),H(X,{key:1},[a(g)?(c(),P(h,{key:0},{default:i(()=>[r(M,{class:"pb-4"},{default:i(()=>[r(Y,null,{default:i(()=>e[4]||(e[4]=[u("Data PTK")])),_:1,__:[4]})]),_:1}),r(I),r(K,{class:"d-flex flex-wrap gap-4"},{default:i(()=>[x("div",se,[r(o,{modelValue:a(s).itemsPerPage,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).itemsPerPage=t),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),r(le),x("div",re,[r(f,{modelValue:a(s).searchQuery,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).searchQuery=t),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),r(I),r(O,{page:a(s).page,"onUpdate:page":e[2]||(e[2]=t=>a(s).page=t),"items-per-page":a(s).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:a(y),"server-items-length":a(V),"items-length":a(V),headers:R,"items-per-page-text":"Item",options:a(s),loading:a(b),"loading-text":"Loading...","onUpdate:sortBy":$,"header-props":{class:"text-no-wrap"}},{"item.induk":i(({item:t})=>[r(o,{items:[{title:"Ya",value:1},{title:"Tidak",value:0}],modelValue:a(n).ptk_induk[t.ptk_terdaftar.ptk_terdaftar_id],"onUpdate:modelValue":p=>a(n).ptk_induk[t.ptk_terdaftar.ptk_terdaftar_id]=p},null,8,["modelValue","onUpdate:modelValue"])]),"item.jenis_ptk":i(({item:t})=>[r(w,{modelValue:a(n).jenis_ptk_id[t.ptk_terdaftar.ptk_terdaftar_id],"onUpdate:modelValue":[p=>a(n).jenis_ptk_id[t.ptk_terdaftar.ptk_terdaftar_id]=p,p=>L(t.ptk_terdaftar.ptk_terdaftar_id,p)],items:a(T),placeholder:"== Pilih Jenis PTK ==","item-title":"jenis_ptk","item-value":"jenis_ptk_id"},null,8,["modelValue","onUpdate:modelValue","items"])]),"item.jabatan_ptk":i(({item:t})=>[r(w,{modelValue:a(n).jabatan_ptk_id[t.ptk_terdaftar.ptk_terdaftar_id],"onUpdate:modelValue":p=>a(n).jabatan_ptk_id[t.ptk_terdaftar.ptk_terdaftar_id]=p,items:a(j)[t.ptk_terdaftar.ptk_terdaftar_id],placeholder:"== Pilih Jabatan PTK ==","item-title":"jabatan_ptk","item-value":"jabatan_ptk_id",disabled:a(k)[t.ptk_terdaftar.ptk_terdaftar_id],loading:a(k)[t.ptk_terdaftar.ptk_terdaftar_id]},null,8,["modelValue","onUpdate:modelValue","items","disabled","loading"])]),"item.aksi":i(({item:t})=>[r(ae,{size:"small",onClick:p=>J(t.ptk_terdaftar.ptk_terdaftar_id),disabled:a(m)[t.ptk_terdaftar.ptk_terdaftar_id],loading:a(m)[t.ptk_terdaftar.ptk_terdaftar_id]},{default:i(()=>e[5]||(e[5]=[u("Simpan")])),_:2,__:[5]},1032,["onClick","disabled","loading"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"])]),_:1})):(c(),P(h,{key:1,color:"#007BB6"},{default:i(()=>[r(K,null,{default:i(()=>[x("p",oe,[e[7]||(e[7]=u(" Data Sekolah tidak ditemukan. Silahkan Simpan Data Sekolah terlebih dahulu ")),r(N,{class:"text-success ms-1",to:{name:"root"}},{default:i(()=>e[6]||(e[6]=[u(" disini ")])),_:1,__:[6]})])]),_:1})]),_:1})),r(F,{modelValue:a(_),"onUpdate:modelValue":e[3]||(e[3]=t=>W(_)?_.value=t:null),color:"success",location:"top end"},{default:i(()=>e[8]||(e[8]=[u(" PTK berhasil disimpan. ")])),_:1,__:[8]},8,["modelValue"])],64))}}};export{Ue as default};
